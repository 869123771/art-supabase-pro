var e=Object.defineProperty,n=Object.defineProperties,o=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,l=(n,o,t)=>o in n?e(n,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[o]=t,r=(e,n)=>{for(var o in n||(n={}))a.call(n,o)&&l(e,o,n[o]);if(t)for(var o of t(n))s.call(n,o)&&l(e,o,n[o]);return e},i=(e,n,o)=>new Promise((t,a)=>{var s=e=>{try{r(o.next(e))}catch(n){a(n)}},l=e=>{try{r(o.throw(e))}catch(n){a(n)}},r=e=>e.done?t(e.value):Promise.resolve(e.value).then(s,l);r((o=o.apply(e,n)).next())});import{n as c,U as u,V as d,_ as p,E as f,b as m,y as g,z as v,H as y,k as b,f as h,g as C,aE as x,e as E,c as B,au as w,h as k,j as I,B as T,r as M,a6 as P,i as j,Y as O,d as S,cg as z,a5 as L,ch as R,l as A,ci as _,ba as V,w as $,o as D,a as H,t as K,m as q,p as U,b2 as F,a4 as W,cj as X,bn as Y,ck as Z,cl as G,cm as J,ah as N,c7 as Q,ae as ee}from"./index-DHdgQId_.js";import{E as ne}from"./el-button-0c2o2QLg.js";import{E as oe}from"./index-ci4gPeH2.js";import{E as te,u as ae,a as se,b as le}from"./index-enXvaKOk.js";import{o as re,E as ie}from"./focus-trap-CUkHjRSh.js";import{i as ce}from"./validator-BQ-PZgIx.js";import{b as ue}from"./index-Bc4hPq7U.js";const de="_trap-focus-children",pe=[],fe=e=>{if(0===pe.length)return;const n=u(e),o=pe[pe.length-1][de];if(o.length>0&&n===d.tab){if(1===o.length)return e.preventDefault(),void(document.activeElement!==o[0]&&o[0].focus());const n=e.shiftKey,t=e.target===o[0],a=e.target===o[o.length-1];t&&n&&(e.preventDefault(),o[o.length-1].focus()),a&&!n&&(e.preventDefault(),o[0].focus())}},me=S({name:"ElMessageBox",directives:{TrapFocus:{beforeMount(e){e[de]=re(e),pe.push(e),pe.length<=1&&document.addEventListener("keydown",fe)},updated(e){c(()=>{e[de]=re(e)})},unmounted(){pe.shift(),0===pe.length&&document.removeEventListener("keydown",fe)}}},components:r({ElButton:ne,ElFocusTrap:ie,ElInput:oe,ElOverlay:te,ElIcon:L},z),inheritAttrs:!1,props:{buttonSize:{type:String,validator:ce},modal:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},closeOnHashChange:{type:Boolean,default:!0},center:Boolean,draggable:Boolean,overflow:Boolean,roundButton:Boolean,container:{type:String,default:"body"},boxType:{type:String,default:""}},emits:["vanish","action"],setup(e,{emit:t}){const{locale:a,zIndex:s,ns:l,size:u}=R("message-box",U(()=>e.buttonSize)),{t:d}=a,{nextZIndex:p}=s,f=q(!1),m=A({autofocus:!0,beforeClose:null,callback:null,cancelButtonText:"",cancelButtonClass:"",confirmButtonText:"",confirmButtonClass:"",cancelButtonType:"",confirmButtonType:"primary",customClass:"",customStyle:{},dangerouslyUseHTMLString:!1,distinguishCancelAndClose:!1,icon:"",closeIcon:"",inputPattern:null,inputPlaceholder:"",inputType:"text",inputValue:"",inputValidator:void 0,inputErrorMessage:"",message:"",modalFade:!0,modalClass:"",showCancelButton:!1,showConfirmButton:!0,type:"",title:void 0,showInput:!1,action:"",confirmButtonLoading:!1,cancelButtonLoading:!1,confirmButtonLoadingIcon:_(V),cancelButtonLoadingIcon:_(V),confirmButtonDisabled:!1,editorErrorMessage:"",validateError:!1,zIndex:p()}),g=U(()=>{const e=m.type;return{[l.bm("icon",e)]:e&&X[e]}}),v=ue(),y=ue(),b=U(()=>{const e=m.type;return m.icon||e&&X[e]||""}),h=U(()=>!!m.message),C=q(),x=q(),E=q(),B=q(),w=q(),k=U(()=>m.confirmButtonClass);$(()=>m.inputValue,n=>i(null,null,function*(){yield c(),"prompt"===e.boxType&&n&&z()}),{immediate:!0}),$(()=>f.value,n=>{var o,t;n&&("prompt"!==e.boxType&&(m.autofocus?E.value=null!=(t=null==(o=w.value)?void 0:o.$el)?t:C.value:E.value=C.value),m.zIndex=p()),"prompt"===e.boxType&&(n?c().then(()=>{var e;B.value&&B.value.$el&&(m.autofocus?E.value=null!=(e=L())?e:C.value:E.value=C.value)}):(m.editorErrorMessage="",m.validateError=!1))});const I=U(()=>e.draggable),T=U(()=>e.overflow),{isDragging:M}=ae(C,x,I,T);function P(){f.value&&(f.value=!1,c(()=>{m.action&&t("action",m.action)}))}D(()=>i(null,null,function*(){yield c(),e.closeOnHashChange&&window.addEventListener("hashchange",P)})),H(()=>{e.closeOnHashChange&&window.removeEventListener("hashchange",P)});const j=()=>{e.closeOnClickModal&&S(m.distinguishCancelAndClose?"close":"cancel")},O=le(j),S=n=>{var o;("prompt"!==e.boxType||"confirm"!==n||z())&&(m.action=n,m.beforeClose?null==(o=m.beforeClose)||o.call(m,n,m,P):P())},z=()=>{if("prompt"===e.boxType){const e=m.inputPattern;if(e&&!e.test(m.inputValue||""))return m.editorErrorMessage=m.inputErrorMessage||d("el.messagebox.error"),m.validateError=!0,!1;const n=m.inputValidator;if(F(n)){const e=n(m.inputValue);if(!1===e)return m.editorErrorMessage=m.inputErrorMessage||d("el.messagebox.error"),m.validateError=!0,!1;if(W(e))return m.editorErrorMessage=e,m.validateError=!0,!1}}return m.editorErrorMessage="",m.validateError=!1,!0},L=()=>{var e,n;const o=null==(e=B.value)?void 0:e.$refs;return null!=(n=null==o?void 0:o.input)?n:null==o?void 0:o.textarea},Y=()=>{S("close")};return e.lockScroll&&se(f,{ns:l}),Z=r({},K(m)),n(Z,o({ns:l,overlayEvent:O,visible:f,hasMessage:h,typeClass:g,contentId:v,inputId:y,btnSize:u,iconComponent:b,confirmButtonClasses:k,rootRef:C,focusStartRef:E,headerRef:x,inputRef:B,isDragging:M,confirmRef:w,doClose:P,handleClose:Y,onCloseRequested:()=>{e.closeOnPressEscape&&Y()},handleWrapperClick:j,handleInputEnter:e=>{if("textarea"!==m.inputType)return e.preventDefault(),S("confirm")},handleAction:S,t:d}));var Z}}),ge=["aria-label","aria-describedby"],ve=["aria-label"],ye=["id"];var be=p(me,[["render",function(e,n,o,t,a,s){const l=f("el-icon"),r=f("el-input"),i=f("el-button"),c=f("el-focus-trap"),u=f("el-overlay");return m(),g(O,{name:"fade-in-linear",onAfterLeave:n[11]||(n[11]=n=>e.$emit("vanish")),persisted:""},{default:v(()=>[y(b(u,{"z-index":e.zIndex,"overlay-class":[e.ns.is("message-box"),e.modalClass],mask:e.modal},{default:v(()=>[h("div",{role:"dialog","aria-label":e.title,"aria-modal":"true","aria-describedby":e.showInput?void 0:e.contentId,class:C(`${e.ns.namespace.value}-overlay-message-box`),onClick:n[8]||(n[8]=(...n)=>e.overlayEvent.onClick&&e.overlayEvent.onClick(...n)),onMousedown:n[9]||(n[9]=(...n)=>e.overlayEvent.onMousedown&&e.overlayEvent.onMousedown(...n)),onMouseup:n[10]||(n[10]=(...n)=>e.overlayEvent.onMouseup&&e.overlayEvent.onMouseup(...n))},[b(c,{loop:"",trapped:e.visible,"focus-trap-el":e.rootRef,"focus-start-el":e.focusStartRef,onReleaseRequested:e.onCloseRequested},{default:v(()=>[h("div",{ref:"rootRef",class:C([e.ns.b(),e.customClass,e.ns.is("draggable",e.draggable),e.ns.is("dragging",e.isDragging),{[e.ns.m("center")]:e.center}]),style:E(e.customStyle),tabindex:"-1",onClick:n[7]||(n[7]=x(()=>{},["stop"]))},[null!==e.title&&void 0!==e.title?(m(),B("div",{key:0,ref:"headerRef",class:C([e.ns.e("header"),{"show-close":e.showClose}])},[h("div",{class:C(e.ns.e("title"))},[e.iconComponent&&e.center?(m(),g(l,{key:0,class:C([e.ns.e("status"),e.typeClass])},{default:v(()=>[(m(),g(w(e.iconComponent)))]),_:1},8,["class"])):k("v-if",!0),h("span",null,I(e.title),1)],2),e.showClose?(m(),B("button",{key:0,type:"button",class:C(e.ns.e("headerbtn")),"aria-label":e.t("el.messagebox.close"),onClick:n[0]||(n[0]=n=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel")),onKeydown:n[1]||(n[1]=T(x(n=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel"),["prevent"]),["enter"]))},[b(l,{class:C(e.ns.e("close"))},{default:v(()=>[(m(),g(w(e.closeIcon||"close")))]),_:1},8,["class"])],42,ve)):k("v-if",!0)],2)):k("v-if",!0),h("div",{id:e.contentId,class:C(e.ns.e("content"))},[h("div",{class:C(e.ns.e("container"))},[e.iconComponent&&!e.center&&e.hasMessage?(m(),g(l,{key:0,class:C([e.ns.e("status"),e.typeClass])},{default:v(()=>[(m(),g(w(e.iconComponent)))]),_:1},8,["class"])):k("v-if",!0),e.hasMessage?(m(),B("div",{key:1,class:C(e.ns.e("message"))},[M(e.$slots,"default",{},()=>[e.dangerouslyUseHTMLString?(m(),g(w(e.showInput?"label":"p"),{key:1,for:e.showInput?e.inputId:void 0,innerHTML:e.message},null,8,["for","innerHTML"])):(m(),g(w(e.showInput?"label":"p"),{key:0,for:e.showInput?e.inputId:void 0,textContent:I(e.message)},null,8,["for","textContent"]))])],2)):k("v-if",!0)],2),y(h("div",{class:C(e.ns.e("input"))},[b(r,{id:e.inputId,ref:"inputRef",modelValue:e.inputValue,"onUpdate:modelValue":n[2]||(n[2]=n=>e.inputValue=n),type:e.inputType,placeholder:e.inputPlaceholder,"aria-invalid":e.validateError,class:C({invalid:e.validateError}),onKeydown:T(e.handleInputEnter,["enter"])},null,8,["id","modelValue","type","placeholder","aria-invalid","class","onKeydown"]),h("div",{class:C(e.ns.e("errormsg")),style:E({visibility:e.editorErrorMessage?"visible":"hidden"})},I(e.editorErrorMessage),7)],2),[[P,e.showInput]])],10,ye),h("div",{class:C(e.ns.e("btns"))},[e.showCancelButton?(m(),g(i,{key:0,type:"text"===e.cancelButtonType?"":e.cancelButtonType,text:"text"===e.cancelButtonType,loading:e.cancelButtonLoading,"loading-icon":e.cancelButtonLoadingIcon,class:C([e.cancelButtonClass]),round:e.roundButton,size:e.btnSize,onClick:n[3]||(n[3]=n=>e.handleAction("cancel")),onKeydown:n[4]||(n[4]=T(x(n=>e.handleAction("cancel"),["prevent"]),["enter"]))},{default:v(()=>[j(I(e.cancelButtonText||e.t("el.messagebox.cancel")),1)]),_:1},8,["type","text","loading","loading-icon","class","round","size"])):k("v-if",!0),y(b(i,{ref:"confirmRef",type:"text"===e.confirmButtonType?"":e.confirmButtonType,text:"text"===e.confirmButtonType,loading:e.confirmButtonLoading,"loading-icon":e.confirmButtonLoadingIcon,class:C([e.confirmButtonClasses]),round:e.roundButton,disabled:e.confirmButtonDisabled,size:e.btnSize,onClick:n[5]||(n[5]=n=>e.handleAction("confirm")),onKeydown:n[6]||(n[6]=T(x(n=>e.handleAction("confirm"),["prevent"]),["enter"]))},{default:v(()=>[j(I(e.confirmButtonText||e.t("el.messagebox.confirm")),1)]),_:1},8,["type","text","loading","loading-icon","class","round","disabled","size"]),[[P,e.showConfirmButton]])],2)],6)]),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])],42,ge)]),_:3},8,["z-index","overlay-class","mask"]),[[P,e.visible]])]),_:3})}],["__file","/home/runner/work/element-plus/element-plus/packages/components/message-box/src/index.vue"]]);const he=new Map,Ce=(e,n,o=null)=>{const t=b(be,e,F(e.message)||Z(e.message)?{default:F(e.message)?e.message:()=>e.message}:null);return t.appContext=o,G(t,n),(e=>{let n=document.body;return e.appendTo&&(W(e.appendTo)&&(n=document.querySelector(e.appendTo)),Q(e.appendTo)&&(n=e.appendTo),Q(n)||(n=document.body)),n})(e).appendChild(n.firstElementChild),t.component},xe=(e,n)=>{const o=document.createElement("div");e.onVanish=()=>{G(null,o),he.delete(a)},e.onAction=n=>{const o=he.get(a);let s;s=e.showInput?{value:a.inputValue,action:n}:n,e.callback?e.callback(s,t.proxy):"cancel"===n||"close"===n?e.distinguishCancelAndClose&&"cancel"!==n?o.reject("close"):o.reject("cancel"):o.resolve(s)};const t=Ce(e,o,n),a=t.proxy;for(const s in e)J(e,s)&&!J(a.$props,s)&&("closeIcon"===s&&N(e[s])?a[s]=_(e[s]):a[s]=e[s]);return a.visible=!0,a};function Ee(e,n=null){if(!Y)return Promise.reject();let o;return W(e)||Z(e)?e={message:e}:o=e.callback,new Promise((t,a)=>{const s=xe(e,null!=n?n:Ee._context);he.set(s,{options:e,callback:o,resolve:t,reject:a})})}const Be={alert:{closeOnPressEscape:!1,closeOnClickModal:!1},confirm:{showCancelButton:!0},prompt:{showCancelButton:!0,showInput:!0}};["alert","confirm","prompt"].forEach(e=>{Ee[e]=function(e){return(n,o,t,a)=>{let s="";return N(o)?(t=o,s=""):s=ee(o)?"":o,Ee(Object.assign(r({title:s,message:n,type:""},Be[e]),t,{boxType:e}),a)}}(e)}),Ee.close=()=>{he.forEach((e,n)=>{n.doClose()}),he.clear()},Ee._context=null;const we=Ee;we.install=e=>{we._context=e._context,e.config.globalProperties.$msgbox=we,e.config.globalProperties.$messageBox=we,e.config.globalProperties.$alert=we.alert,e.config.globalProperties.$confirm=we.confirm,e.config.globalProperties.$prompt=we.prompt};const ke=we;export{ke as E};
