var e=Object.defineProperty,t=Object.defineProperties,s=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,o=(t,s,a)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a,i=(e,t)=>{for(var s in t||(t={}))l.call(t,s)&&o(e,s,t[s]);if(a)for(var s of a(t))r.call(t,s)&&o(e,s,t[s]);return e},n=(e,a)=>t(e,s(a));import{d as u,t as d,o as c,n as p,a as m,b as g,c as h,e as v,u as f,f as x,g as y,r as b,h as w,i as _,j as k,k as j,l as T,m as B,p as M,q as $,s as P,v as E,w as O,x as F,A as L,y as V,z as I,B as z,C,D as X,E as D,F as q,G as R,H as S,I as A,J as U,K as Y}from"./index-DocD4lg6.js";import{E as H,a as K}from"./el-form-item-BATHfeAQ.js";import{E as G}from"./el-button-D_FpX5vN.js";/* empty css                    */import{_ as J}from"./index.vue_vue_type_script_setup_true_lang-CQ-lFaSs.js";import{_ as W}from"./_plugin-vue_export-helper-BCo6x5W8.js";/* empty css                 */import{_ as Z,a as N}from"./LoginLeftView-DkaQ6sCC.js";import{E as Q}from"./index-BQDo0aJw.js";import{E as ee}from"./index-CIjb2oSb.js";import"./index-B8YGeOD4.js";import"./error-D_Dr4eZ1.js";import"./_baseClone-l1ALzJG5.js";import"./use-form-item-CYVSqIfx.js";import"./el-dropdown-item-BV4GnYEc.js";import"./index-CXepPrJW.js";import"./index-DmiZVFYU.js";import"./focus-trap-CMJEhiq8.js";import"./index-NP_uivuD.js";import"./refs-Cw5r5QN8.js";/* empty css                  *//* empty css                     */import"./index.vue_vue_type_script_setup_true_lang-DCyxtPTi.js";import"./index-BkO8hyfy.js";import"./event-BwRzfsZt.js";import"./omit-Ba47H9Mc.js";const te=W(u(n(i({},{name:"ArtDragVerify"}),{__name:"index",props:{value:{type:Boolean,default:!1},width:{default:"100%"},height:{default:40},text:{default:"按住滑块拖动"},successText:{default:"success"},background:{default:"#eee"},progressBarBg:{default:"#1385FF"},completedBg:{default:"#57D187"},circle:{type:Boolean,default:!1},radius:{default:"calc(var(--custom-radius) / 3 + 2px)"},handlerIcon:{default:"solar:double-alt-arrow-right-linear"},successIcon:{default:"ri:check-fill"},handlerBg:{default:"#fff"},textSize:{default:"13px"},textColor:{default:"#333"}},emits:["handlerMove","update:value","passCallback"],setup(e,{expose:t,emit:s}){const a=s,l=e,r=T({isMoving:!1,x:0,isOk:!1}),{isOk:o}=d(r),i=B(),n=B(),u=B(),$=B();let P,E,O,F;const L=e=>{P=e.targetTouches[0].pageX,E=e.targetTouches[0].pageY},V=e=>{O=e.targetTouches[0].pageX,F=e.targetTouches[0].pageY,Math.abs(O-P)>Math.abs(F-E)&&e.preventDefault()};document.addEventListener("touchstart",L),document.addEventListener("touchmove",V,{passive:!1});const I=()=>{var e;return"string"==typeof l.width?(null==(e=i.value)?void 0:e.offsetWidth)||260:l.width};c(()=>{var e;null==(e=i.value)||e.style.setProperty("--textColor",l.textColor),p(()=>{var e,t;const s=I();null==(e=i.value)||e.style.setProperty("--width",Math.floor(s/2)+"px"),null==(t=i.value)||t.style.setProperty("--pwidth",-Math.floor(s/2)+"px")}),document.addEventListener("touchstart",L),document.addEventListener("touchmove",V,{passive:!1})}),m(()=>{document.removeEventListener("touchstart",L),document.removeEventListener("touchmove",V)});const z={left:"0",width:l.height+"px",height:l.height+"px",background:l.handlerBg},C=M(()=>({width:"string"==typeof l.width?l.width:l.width+"px",height:l.height+"px",lineHeight:l.height+"px",background:l.background,borderRadius:l.circle?l.height/2+"px":l.radius})),X={background:l.progressBarBg,height:l.height+"px",borderRadius:l.circle?l.height/2+"px 0 0 "+l.height/2+"px":l.radius},D=M(()=>({fontSize:l.textSize})),q=M(()=>l.value?l.successText:l.text),R=e=>{l.value||(r.isMoving=!0,u.value.style.transition="none",r.x=(e.pageX||e.touches[0].pageX)-parseInt(u.value.style.left.replace("px",""),10)),a("handlerMove")},S=e=>{if(r.isMoving&&!l.value){const t=I();let s=(e.pageX||e.touches[0].pageX)-r.x;s>0&&s<=t-l.height?(u.value.style.left=s+"px",$.value.style.width=s+l.height/2+"px"):s>t-l.height&&(u.value.style.left=t-l.height+"px",$.value.style.width=t-l.height/2+"px",U())}},A=e=>{if(r.isMoving&&!l.value){const t=I();(e.pageX||e.changedTouches[0].pageX)-r.x<t-l.height?(r.isOk=!0,u.value.style.left="0",u.value.style.transition="all 0.2s",$.value.style.width="0",r.isOk=!1):(u.value.style.transition="none",u.value.style.left=t-l.height+"px",$.value.style.width=t-l.height/2+"px",U()),r.isMoving=!1}},U=()=>{a("update:value",!0),r.isMoving=!1,$.value.style.background=l.completedBg,n.value.style["-webkit-text-fill-color"]="unset",n.value.style.animation="slidetounlock2 2s cubic-bezier(0, 0.2, 1, 1) infinite",n.value.style.color="#fff",a("passCallback")};return t({reset:()=>{u.value.style.left="0",$.value.style.width="0",$.value.style.background=l.progressBarBg,n.value.style["-webkit-text-fill-color"]="transparent",n.value.style.animation="slidetounlock 2s cubic-bezier(0, 0.2, 1, 1) infinite",n.value.style.color=l.background,a("update:value",!1),r.isOk=!1,r.isMoving=!1,r.x=0}}),(t,s)=>{const a=J;return g(),h("div",{ref_key:"dragVerify",ref:i,class:"drag_verify",style:v(f(C)),onMousemove:S,onMouseup:A,onMouseleave:A,onTouchmove:S,onTouchend:A},[x("div",{class:y(["dv_progress_bar",{goFirst2:f(o)}]),ref_key:"progressBar",ref:$,style:X},null,2),x("div",{class:"dv_text",style:v(f(D)),ref_key:"messageRef",ref:n},[t.$slots.textBefore?b(t.$slots,"textBefore",{key:0},void 0,!0):w("",!0),_(" "+k(f(q))+" ",1),t.$slots.textAfter?b(t.$slots,"textAfter",{key:1},void 0,!0):w("",!0)],4),x("div",{class:y(["dv_handler dv_handler_bg",{goFirst:f(o)}]),onMousedown:R,onTouchstart:R,ref_key:"handler",ref:u,style:z},[j(a,{icon:e.value?e.successIcon:e.handlerIcon,class:"text-g-600"},null,8,["icon"])],34)],36)}}})),[["__scopeId","data-v-265b66f3"]]),se={class:"flex w-full h-screen"},ae={class:"relative flex-1"},le={class:"auth-right-wrap"},re={class:"form"},oe={class:"title"},ie={class:"sub-title"},ne={class:"relative pb-5 mt-6"},ue={class:"flex-cb mt-2 text-sm"},de={style:{"margin-top":"30px"}},ce={class:"mt-5 text-sm text-gray-600"},pe=W(u(n(i({},{name:"Login"}),{__name:"index",setup(e){const t=$(),{isDark:s}=P(t),{t:a,locale:l}=E(),r=B(0);O(l,()=>{r.value++});const o=B(),i=F(),n=C(),u=X(),d=B(!1),p=B(!1),m=L.systemInfo.name,v=B(),b=T({account:"",username:"",email:"624944977@qq.com",password:"wang3763237",rememberPassword:!0}),w=M(()=>({username:[{required:!0,message:a("login.placeholder.username"),trigger:"blur"}],password:[{required:!0,message:a("login.placeholder.password"),trigger:"blur"}]})),U=B(!1);c(()=>{});const J=()=>{return e=null,t=null,s=function*(){if(v.value)try{if(!(yield v.value.validate()))return;if(!d.value)return void(p.value=!0);U.value=!0;const{email:e,password:t}=b,s={email:e,password:t},{data:a}=yield A(s),{refreshToken:l,accessToken:r}=a.session;if(!r)throw new Error("Login failed - no token received");i.setToken(r,l),i.setLoginStatus(!0),yield i.fetchUserInfo(),yield i.fetchDictList(),pe();const o=u.query.redirect;yield n.push(o||"/")}catch(e){}finally{U.value=!1,W()}},new Promise((a,l)=>{var r=e=>{try{i(s.next(e))}catch(t){l(t)}},o=e=>{try{i(s.throw(e))}catch(t){l(t)}},i=e=>e.done?a(e.value):Promise.resolve(e.value).then(r,o);i((s=s.apply(e,t)).next())});var e,t,s},W=()=>{var e,t;null==(t=null==(e=o.value)?void 0:e.reset)||t.call(e)},pe=()=>{setTimeout(()=>{Y({title:a("login.success.title"),type:"success",duration:2500,zIndex:1e4,message:`${a("login.success.message")}, ${m}!`})},1e3)};return(e,t)=>{const a=Z,l=N,i=Q,n=K,u=te,c=ee,m=D("RouterLink"),T=G,B=H,M=q("ripple");return g(),h("div",se,[j(a),x("div",ae,[j(l),x("div",le,[x("div",re,[x("h3",oe,k(e.$t("login.title")),1),x("p",ie,k(e.$t("login.subTitle")),1),(g(),V(B,{ref_key:"formRef",ref:v,model:f(b),rules:f(w),key:f(r),onKeyup:z(J,["enter"]),class:"mt-[25px]"},{default:I(()=>[j(n,{prop:"email"},{default:I(()=>[j(i,{class:"custom-height",placeholder:e.$t("login.placeholder.email"),modelValue:f(b).email,"onUpdate:modelValue":t[0]||(t[0]=e=>f(b).email=e),modelModifiers:{trim:!0}},null,8,["placeholder","modelValue"])]),_:1}),j(n,{prop:"password"},{default:I(()=>[j(i,{class:"custom-height",placeholder:e.$t("login.placeholder.password"),modelValue:f(b).password,"onUpdate:modelValue":t[1]||(t[1]=e=>f(b).password=e),modelModifiers:{trim:!0},type:"password",autocomplete:"off","show-password":""},null,8,["placeholder","modelValue"])]),_:1}),x("div",ne,[x("div",{class:y(["relative z-[2] overflow-hidden select-none rounded-lg border border-transparent tad-300",{"!border-[#FF4E4F]":!f(d)&&f(p)}])},[j(u,{ref_key:"dragVerify",ref:o,value:f(d),"onUpdate:value":t[2]||(t[2]=e=>R(d)?d.value=e:null),text:e.$t("login.sliderText"),textColor:"var(--art-gray-700)",successText:e.$t("login.sliderSuccessText"),progressBarBg:"var(--main-color)",background:f(s)?"#26272F":"#F1F1F4",handlerBg:"var(--default-box-color)"},null,8,["value","text","successText","background"])],2),x("p",{class:y(["absolute top-0 z-[1] px-px mt-2 text-xs text-[#f56c6c] tad-300",{"translate-y-10":!f(d)&&f(p)}])},k(e.$t("login.placeholder.slider")),3)]),x("div",ue,[j(c,{modelValue:f(b).rememberPassword,"onUpdate:modelValue":t[3]||(t[3]=e=>f(b).rememberPassword=e)},{default:I(()=>[_(k(e.$t("login.rememberPwd")),1)]),_:1},8,["modelValue"]),j(m,{class:"text-theme",to:{name:"ForgetPassword"}},{default:I(()=>[_(k(e.$t("login.forgetPwd")),1)]),_:1})]),x("div",de,[S((g(),V(T,{class:"w-full custom-height",type:"primary",onClick:J,loading:f(U)},{default:I(()=>[_(k(e.$t("login.btnText")),1)]),_:1},8,["loading"])),[[M]])]),x("div",ce,[x("span",null,k(e.$t("login.noAccount")),1),j(m,{class:"text-theme",to:{name:"Register"}},{default:I(()=>[_(k(e.$t("login.register")),1)]),_:1})])]),_:1},8,["model","rules"]))])])])])}}})),[["__scopeId","data-v-391fb588"]]);export{pe as default};
