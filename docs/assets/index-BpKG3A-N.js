var e=Object.defineProperty,r=Object.defineProperties,t=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,i=(r,t,s)=>t in r?e(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,n=(e,r)=>{for(var t in r||(r={}))o.call(r,t)&&i(e,t,r[t]);if(s)for(var t of s(r))a.call(r,t)&&i(e,t,r[t]);return e},l=(e,r,t)=>new Promise((s,o)=>{var a=e=>{try{n(t.next(e))}catch(r){o(r)}},i=e=>{try{n(t.throw(e))}catch(r){o(r)}},n=e=>e.done?s(e.value):Promise.resolve(e.value).then(a,i);n((t=t.apply(e,r)).next())});import{d as p,x as u,F as m,b as c,c as d,k as j,u as f,G as _,z as v,H as y,y as g,i as b,m as x,n as h,a3 as w,e3 as P,ef as k,eg as C,eh as T}from"./index-DHdgQId_.js";import{E}from"./el-card-DFmHUaKG.js";import{_ as O}from"./index-C2ZFKNRi.js";import{_ as B}from"./index-C2NT0vod.js";import{E as S,p as R}from"./el-space-DDXYGDqB.js";import{E as D}from"./el-button-0c2o2QLg.js";import{_ as L}from"./index.vue_vue_type_script_setup_true_lang-Bd222Qnp.js";import{u as V}from"./useTable-DWndMqIl.js";import{_ as z}from"./user-search.vue_vue_type_script_setup_true_lang-HQO-U_To.js";import{_ as G}from"./user-dialog.vue_vue_type_script_setup_true_lang-C-Rb0w2j.js";import"./tree-select-CPuxTqV_.js";import{E as N}from"./overlay-Ds1eBgJc.js";/* empty css              */import{_ as U}from"./index.vue_vue_type_script_setup_true_lang-aCgauC2P.js";import{_ as F}from"./user-role-dialog.vue_vue_type_script_setup_true_lang-CSpU-yI-.js";import{E as q}from"./panel-RLfpES5r.js";import{b as A}from"./el-option-Ct8FZxN7.js";import"./el-empty-EjDuF44L.js";import"./index-Bc4hPq7U.js";import"./index-ci4gPeH2.js";import"./index-CJHBY14B.js";import"./event-BwRzfsZt.js";import"./focus-trap-CUkHjRSh.js";/* empty css               *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                    *//* empty css                   */import"./index-CDL13igh.js";import"./index-cfyCizLf.js";import"./_baseClone-Do42dbT3.js";import"./isArrayLikeObject-RE9YRrkx.js";import"./omit-Dn9XeOP_.js";import"./debounce-B272wxs9.js";import"./toNumber-CtH2CKpA.js";import"./index-99KMa0En.js";import"./_plugin-vue_export-helper-BCo6x5W8.js";/* empty css                   */import"./el-dropdown-item-bk8prIMw.js";import"./refs-Cw5r5QN8.js";import"./index.vue_vue_type_script_setup_true_lang-BLNSALDk.js";import"./index-BgA9WuFL.js";import"./vnode-B83KbSSl.js";import"./index-Dkm5XP97.js";import"./el-form-item-vI0w3RAk.js";import"./el-row-deoSVNxC.js";import"./el-col-DLpe40ZC.js";import"./el-radio-C4KzvC8M.js";import"./index-B5xS5dLt.js";import"./validator-BQ-PZgIx.js";import"./index--zanLudC.js";import"./el-dialog-CvbxKYde.js";import"./index-enXvaKOk.js";import"./el-overlay-D6YYUai9.js";/* empty css                        */import"./el-progress-B91qoi2b.js";import"./index-C-Y6gi98.js";import"./cloneDeep-BgGA_MGi.js";import"./isEmpty-B-SMALGS.js";import"./index-BxgJu9aB.js";import"./index-DcM-YV4m.js";import"./index-Bsy5TWWF.js";import"./index.vue_vue_type_script_setup_true_lang-4F3V0pfX.js";import"./index.vue_vue_type_script_setup_true_lang-DEUhHID8.js";import"./index-CExIVi5t.js";const I={class:"user-page art-full-height"},W=p((X=n({},{name:"User"}),r(X,t({__name:"index",setup(e){const r=u(),t=x("add"),s=x(!1),o=x({}),a=x(),i=x([]),p=x({userName:void 0,userGender:void 0,userPhone:void 0,userEmail:void 0,status:""}),{columns:W,columnChecks:X,data:Y,loading:Z,pagination:$,getData:H,searchParams:M,resetSearchParams:Q,handleSizeChange:J,handleCurrentChange:K,refreshData:ee}=V({core:{apiFn:()=>le(),apiParams:n({current:1,size:20},p.value),columnsFactory:()=>[{type:"selection"},{type:"index",width:60,label:"序号"},{prop:"userInfo",label:"用户名",width:280,formatter:e=>w("div",{class:"user flex-c"},[w(q,{class:"size-9.5 rounded-md",src:e.avatar,previewSrcList:[e.avatar||""],previewTeleported:!0}),w("div",{class:"ml-2"},[w("p",{class:"user-name"},e.userName),w("p",{class:"email"},e.userEmail)])])},{prop:"userType",label:"用户类型",formatter:e=>{var t;const s=null!=(t={1:"primary",2:"info"}[String(e.userType)])?t:"info";return w(A,{type:s},()=>r.getDictLabelByValue("userType",(null==e?void 0:e.userType)||""))}},{prop:"userGender",label:"性别",sortable:!0,formatter:e=>r.getDictLabelByValue("sex",e.userGender)},{prop:"userPhone",label:"手机号"},{prop:"status",label:"状态",formatter:e=>{var t;const s=null!=(t={1:"success",2:"danger"}[String(e.status)])?t:"info";return w(A,{type:s},()=>r.getDictLabelByValue("status",(null==e?void 0:e.status)||""))}},{prop:"createTime",label:"创建日期",sortable:!0,width:180,formatter:e=>P(e.createTime)},{prop:"operation",label:"操作",width:120,fixed:"right",formatter:e=>w("div",{class:"flex "},[w(L,{type:"edit",onClick:()=>te("edit",e)}),w(U,{list:()=>{const{info:t}=r,s=["assignRoles","delete"];let o=[{key:"assignRoles",label:"赋予角色",icon:"ri-user-add-line"},{key:"reset",label:"初始化密码",icon:"ri-user-received-line"},{key:"delete",label:"删除用户",icon:"ri:delete-bin-4-line",color:"#f56c6c"}];return t.email===e.userEmail&&(o=o.filter(e=>!s.includes(e.key))),o},onClick:r=>se(r,e)})])}]}}),re=e=>{Object.assign(M,e),H()},te=(e,r)=>{t.value=e,o.value=r||{},h(()=>{s.value=!0})},se=(e,r)=>{switch(e.key){case"assignRoles":a.value.handleOpen(r);break;case"reset":oe(r);break;case"delete":ae(r)}},oe=e=>{N.confirm("是否将用户密码重置为[123456]?","系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",beforeClose:(r,t,s)=>l(null,null,function*(){if("confirm"===r){t.confirmButtonLoading=!0,t.confirmButtonText="处理中...";try{const r={userEmail:e.userEmail,password:"123456"};yield k(r),s()}finally{t.confirmButtonLoading=!1,t.confirmButtonText="确定"}}else s()})})},ae=e=>{N.confirm("确定要注销该用户吗?","注销用户",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>l(null,null,function*(){yield C(e),yield H()}))},ie=()=>l(null,null,function*(){try{s.value=!1,o.value={},yield H()}catch(e){}}),ne=e=>{i.value=e},le=()=>l(null,null,function*(){const{userName:e,userPhone:r,userEmail:t,userGender:s,status:o}=M,{from:a,to:i}=R($);return yield T({userName:e,userPhone:r,userEmail:t,userGender:s,status:o,from:a,to:i})});return(e,r)=>{const i=D,n=S,l=B,u=O,x=E,h=m("ripple");return c(),d("div",I,[j(z,{modelValue:f(p),"onUpdate:modelValue":r[0]||(r[0]=e=>_(p)?p.value=e:null),onSearch:re,onReset:f(Q)},null,8,["modelValue","onReset"]),j(x,{class:"art-table-card",shadow:"never"},{default:v(()=>[j(l,{columns:f(X),"onUpdate:columns":r[2]||(r[2]=e=>_(X)?X.value=e:null),loading:f(Z),onRefresh:f(ee)},{left:v(()=>[j(n,{wrap:""},{default:v(()=>[y((c(),g(i,{onClick:r[1]||(r[1]=e=>te("add"))},{default:v(()=>[...r[4]||(r[4]=[b("新增用户",-1)])]),_:1})),[[h]])]),_:1})]),_:1},8,["columns","loading","onRefresh"]),j(u,{loading:f(Z),data:f(Y),columns:f(W),pagination:f($),onSelectionChange:ne,"onPagination:sizeChange":f(J),"onPagination:currentChange":f(K)},null,8,["loading","data","columns","pagination","onPagination:sizeChange","onPagination:currentChange"]),j(G,{visible:f(s),"onUpdate:visible":r[3]||(r[3]=e=>_(s)?s.value=e:null),type:f(t),"user-data":f(o),onSubmit:ie},null,8,["visible","type","user-data"]),j(F,{ref_key:"userRoleRef",ref:a,onSuccess:f(H)},null,8,["onSuccess"])]),_:1})])}}}))));var X;export{W as default};
