var e=Object.defineProperty,l=Object.defineProperties,a=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,d=(l,a,o)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):l[a]=o,i=(e,l)=>{for(var a in l||(l={}))r.call(l,a)&&d(e,a,l[a]);if(o)for(var a of o(l))t.call(l,a)&&d(e,a,l[a]);return e};import{d as s,a as n,c as u,r as m,w as p,y as c,f,z as g,p as v,u as b,l as y,G as V,bn as h,bs as j,bt as x}from"./index-CSMnfbno.js";import{E as O}from"./el-dialog-D_Pkvt-7.js";import"./el-overlay-ZKdz0fk-.js";import{E as _}from"./el-button-D6QoVWRW.js";import{E as w,a as C}from"./el-form-item-BLLKL5R4.js";/* empty css                  *//* empty css                 */import{u as E}from"./validator-Cym7bfkV.js";import{E as N}from"./index-C8WLZA2V.js";import{E as P}from"./index-DNVaB9JF.js";const D=s({__name:"role-edit-dialog",props:{modelValue:{type:Boolean,default:!1},dialogType:{default:"add"},roleData:{default:void 0}},emits:["update:modelValue","success"],setup(e,{emit:d}){const s=e,D=d,U=n(),T=n(!1),k=u({get:()=>s.modelValue,set:e=>D("update:modelValue",e)}),q=m({roleName:[{required:!0,message:"请输入角色名称",trigger:"change"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"change"}],roleCode:[{required:!0,message:"请输入角色编码",trigger:"change"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"change"},{validator:E({table:"roles",field:"role_code",getExcludeId:()=>null==I?void 0:I.id,message:"角色编码已存在"}),trigger:"change"}],description:[{required:!0,message:"请输入角色描述",trigger:"change"}]}),I=m({roleName:"",roleCode:"",description:"",enabled:!0});p(()=>s.modelValue,e=>{e&&S()}),p(()=>s.roleData,e=>{e&&s.modelValue&&S()},{deep:!0});const S=()=>{var e;const{id:l,roleName:a,roleCode:o,description:r,enabled:t}=null!=(e=s.roleData)?e:{};Object.assign(I,{id:l,roleName:a,roleCode:o,description:r,enabled:t})},z=()=>{var e;k.value=!1,null==(e=U.value)||e.resetFields()},B=()=>{return e=null,d=null,n=function*(){var e,d;if(U.value)try{yield U.value.validate();try{T.value=!0;const n=h(I),{id:u}=n,m=((e,l)=>{var a={};for(var d in e)r.call(e,d)&&l.indexOf(d)<0&&(a[d]=e[d]);if(null!=e&&o)for(var d of o(e))l.indexOf(d)<0&&t.call(e,d)&&(a[d]=e[d]);return a})(n,["id"]),p=i({},m);"add"===s.dialogType?yield j(p):yield x((e=i({},p),d={id:u},l(e,a(d))))}finally{T.value=!1}D("success"),z()}catch(n){}},new Promise((l,a)=>{var o=e=>{try{t(n.next(e))}catch(l){a(l)}},r=e=>{try{t(n.throw(e))}catch(l){a(l)}},t=e=>e.done?l(e.value):Promise.resolve(e.value).then(o,r);t((n=n.apply(e,d)).next())});var e,d,n};return(l,a)=>{const o=N,r=C,t=P,d=w,i=_,s=O;return f(),c(s,{modelValue:b(k),"onUpdate:modelValue":a[4]||(a[4]=e=>V(k)?k.value=e:null),title:"add"===e.dialogType?"新增角色":"编辑角色",width:"30%","align-center":"",onClose:z},{footer:g(()=>[v(i,{onClick:z},{default:g(()=>[...a[5]||(a[5]=[y("取消",-1)])]),_:1}),v(i,{type:"primary",onClick:B,loading:b(T)},{default:g(()=>[...a[6]||(a[6]=[y("提交",-1)])]),_:1},8,["loading"])]),default:g(()=>[v(d,{ref_key:"formRef",ref:U,model:b(I),rules:b(q),"label-width":"120px",class:"pr-6"},{default:g(()=>[v(r,{label:"角色名称",prop:"roleName"},{default:g(()=>[v(o,{modelValue:b(I).roleName,"onUpdate:modelValue":a[0]||(a[0]=e=>b(I).roleName=e),placeholder:"请输入角色名称"},null,8,["modelValue"])]),_:1}),v(r,{label:"角色编码",prop:"roleCode"},{default:g(()=>[v(o,{modelValue:b(I).roleCode,"onUpdate:modelValue":a[1]||(a[1]=e=>b(I).roleCode=e),placeholder:"请输入角色编码"},null,8,["modelValue"])]),_:1}),v(r,{label:"描述",prop:"description"},{default:g(()=>[v(o,{modelValue:b(I).description,"onUpdate:modelValue":a[2]||(a[2]=e=>b(I).description=e),type:"textarea",rows:3,placeholder:"请输入角色描述"},null,8,["modelValue"])]),_:1}),v(r,{label:"启用"},{default:g(()=>[v(t,{modelValue:b(I).enabled,"onUpdate:modelValue":a[3]||(a[3]=e=>b(I).enabled=e)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}});export{D as _};
