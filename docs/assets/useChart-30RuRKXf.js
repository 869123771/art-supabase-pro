var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,r=(t,n,l)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[n]=l,o=(e,t)=>{for(var n in t||(t={}))a.call(t,n)&&r(e,n,t[n]);if(l)for(var n of l(t))i.call(t,n)&&r(e,n,t[n]);return e},s=(e,l)=>t(e,n(l));import{aV as u,c,q as p,s as h,a as m,o as d,b as v,aF as f,w as g,n as y,aZ as b}from"./index-BKps0qP8.js";const L=()=>({chartHeight:"16rem",fontSize:13,fontColor:"#999",themeColor:u("--el-color-primary-light-1"),colors:[u("--el-color-primary-light-1"),"#4ABEFF","#EDF2FF","#14DEBA","#FFAF20","#FA8A6C","#FFAF20"]}),w=[50,100,200,350],E=[50,100,200];function x(e={}){const{initOptions:t,initDelay:n=0,threshold:l=.1,autoTheme:a=!0}=e,i=p(),{isDark:r,menuOpen:u,menuType:c}=h(i),x=m();let C=null,S=null,D=null,O=null,F=null,A=!1,k=null;const z=()=>{F&&cancelAnimationFrame(F),F=requestAnimationFrame(()=>{$(),F=null})},T=()=>{O&&clearTimeout(O),O=window.setTimeout(()=>{z(),O=null},100)},V=e=>{y(z),e.forEach(e=>{setTimeout(z,e)})};let j=null,R=null;let I=null;const B=(e,t=1,n)=>o({color:e,width:t},n&&{type:n}),q={axisLine:null,splitLine:null,axisLabel:null,lastDarkValue:r.value},P=()=>{q.axisLine=null,q.splitLine=null,q.axisLabel=null,q.lastDarkValue=r.value},H=()=>{S&&(S.disconnect(),S=null)},M=e=>{C||!x.value||A||(C=b(x.value),j=g(u,()=>V(w)),R=g(c,()=>{y(z),setTimeout(()=>V(E),0)}),a&&(I=g(r,()=>{W.updateStyle(),C&&!A&&requestAnimationFrame(()=>{if(C&&!A){const e=C.getOption();e&&Z(e)}})}))),C&&!A&&(C.setOption(e),D=null)},W={create:()=>{x.value&&!k&&(k=document.createElement("div"),k.style.cssText=`\n        position: absolute;\n        top: 0;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        justify-content: center;\n        font-size: 12px;\n        color: ${r.value?"#555555":"#B3B2B2"};\n        background: transparent;\n        z-index: 10;\n      `,k.innerHTML="<span>暂无数据</span>","relative"!==x.value.style.position&&"absolute"!==x.value.style.position&&(x.value.style.position="relative"),x.value.appendChild(k))},remove:()=>{k&&x.value&&(x.value.removeChild(k),k=null)},updateStyle:()=>{k&&(k.style.color=r.value?"#666":"#999")}},G=(e={},a=!1)=>{if(!x.value||A)return;const i=o(o({},t),e);try{if(a)return C&&C.clear(),void W.create();W.remove(),(e=>{const t=e.getBoundingClientRect();return t.width>0&&t.height>0&&t.top<window.innerHeight&&t.bottom>0})(x.value)?n>0?setTimeout(()=>M(i),n):M(i):(D=i,!S&&x.value&&(S=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&D&&!A&&requestAnimationFrame(()=>{if(!A&&D)try{C||(C=b(e.target));const t=new CustomEvent("chartVisible",{detail:{options:D}});e.target.dispatchEvent(t),D=null,H()}catch(t){}})})},{threshold:l}),S.observe(x.value)))}catch(r){}},Z=e=>{if(!A)try{if(!C)return void G(e);C.setOption(e)}catch(t){}},$=()=>{if(C&&!A)try{C.resize()}catch(e){}},J=()=>{if(A=!0,C)try{C.dispose()}catch(e){}finally{C=null}null==j||j(),null==R||R(),j=null,R=null,null==I||I(),I=null,W.remove(),H(),O&&(clearTimeout(O),O=null),F&&(cancelAnimationFrame(F),F=null),P(),D=null};return d(()=>{window.addEventListener("resize",T)}),v(()=>{window.removeEventListener("resize",T)}),f(()=>{J()}),{isDark:r,chartRef:x,initChart:G,updateChart:Z,handleResize:$,destroyChart:J,getChartInstance:()=>C,isChartInitialized:()=>null!==C,emptyStateManager:W,getAxisLineStyle:(e=!0)=>(q.lastDarkValue!==r.value&&P(),q.axisLine||(q.axisLine={show:e,lineStyle:B(r.value?"#444":"#EDEDED")}),q.axisLine),getSplitLineStyle:(e=!0)=>(q.lastDarkValue!==r.value&&P(),q.splitLine||(q.splitLine={show:e,lineStyle:B(r.value?"#444":"#EDEDED",1,"dashed")}),q.splitLine),getAxisLabelStyle:(e=!0)=>{if(q.lastDarkValue!==r.value&&P(),!q.axisLabel){const{fontColor:t,fontSize:n}=L();q.axisLabel={show:e,color:t,fontSize:n}}return q.axisLabel},getAxisTickStyle:()=>({show:!1}),getAnimationConfig:(e=50,t=1500)=>({animationDelay:t=>t*e+200,animationDuration:e=>t-50*e,animationEasing:"quarticOut"}),getTooltipStyle:(e="axis",t={})=>o({trigger:e,backgroundColor:r.value?"rgba(0, 0, 0, 0.8)":"rgba(255, 255, 255, 0.9)",borderColor:r.value?"#333":"#ddd",borderWidth:1,textStyle:{color:r.value?"#fff":"#333"}},t),getLegendStyle:(e="bottom",t={})=>{const n=o({textStyle:{color:r.value?"#fff":"#333"},itemWidth:12,itemHeight:12,itemGap:20},t);switch(e){case"bottom":return s(o({},n),{bottom:0,left:"center",orient:"horizontal",icon:"roundRect"});case"top":return s(o({},n),{top:0,left:"center",orient:"horizontal",icon:"roundRect"});case"left":return s(o({},n),{left:0,top:"center",orient:"vertical",icon:"roundRect"});case"right":return s(o({},n),{right:0,top:"center",orient:"vertical",icon:"roundRect"});default:return n}},useChartOps:L,getGridWithLegend:(e,t="bottom",n={})=>{const l=o({top:15,right:15,bottom:8,left:0,containLabel:!0},n);if(!e)return l;switch(t){case"bottom":return s(o({},l),{bottom:40});case"top":return s(o({},l),{top:40});case"left":return s(o({},l),{left:120});case"right":return s(o({},l),{right:120});default:return l}}}}function C(e){const{props:t,generateOptions:n,checkEmpty:l,watchSources:a=[],onVisible:i,chartOptions:r={}}=e,u=x(r),{chartRef:p,initChart:h,isDark:m,emptyStateManager:f}=u,b=c(()=>!!t.isEmpty||!!l&&l()),L=()=>{y(()=>{var e;b.value?(u.getChartInstance()&&(null==(e=u.getChartInstance())||e.clear()),f.create()):(f.remove(),h(n()))})},w=()=>{i?i():L()},E=[];return(()=>{if(a.length>0){const e=g(a,L,{deep:!0});E.push(e)}const e=g(m,()=>{f.updateStyle(),L()});E.push(e)})(),d(()=>{L(),p.value&&p.value.addEventListener("chartVisible",w)}),v(()=>{p.value&&p.value.removeEventListener("chartVisible",w),E.forEach(e=>e()),E.length=0,f.remove()}),s(o({},u),{isEmpty:b,updateChart:L,handleChartVisible:w})}export{C as a,L as u};
