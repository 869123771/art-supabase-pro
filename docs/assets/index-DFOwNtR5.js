var e=Object.defineProperty,r=Object.defineProperties,t=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,a=(r,t,s)=>t in r?e(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s,n=(e,r)=>{for(var t in r||(r={}))o.call(r,t)&&a(e,t,r[t]);if(s)for(var t of s(r))i.call(r,t)&&a(e,t,r[t]);return e},l=(e,r,t)=>new Promise((s,o)=>{var i=e=>{try{n(t.next(e))}catch(r){o(r)}},a=e=>{try{n(t.throw(e))}catch(r){o(r)}},n=e=>e.done?s(e.value):Promise.resolve(e.value).then(i,a);n((t=t.apply(e,r)).next())});import{d as p,x as u,F as m,b as c,c as d,k as j,u as f,G as _,z as v,H as y,y as g,i as b,m as x,n as h,a3 as w,e5 as P,eh as k,ei as E,ej as C}from"./index-Dp_GRdij.js";import{E as T}from"./el-card-CnFHinIA.js";import{_ as B}from"./index-Ztn7boQv.js";import{_ as O}from"./index-DsEcjUp1.js";import{E as S,p as R}from"./el-space-BGTZJtvh.js";import{E as z}from"./el-button-DUuKddpM.js";import{_ as D}from"./index.vue_vue_type_script_setup_true_lang-QsRA2Zgm.js";import{u as G}from"./useTable-jNOkMEVb.js";import{_ as L}from"./user-search.vue_vue_type_script_setup_true_lang-DwSie9sm.js";import{_ as V}from"./user-dialog.vue_vue_type_script_setup_true_lang-s-1om0Dc.js";import"./tree-select-BlNR38ws.js";import{E as N}from"./overlay-DA0WWg4O.js";/* empty css              */import{_ as U}from"./index.vue_vue_type_script_setup_true_lang-CvaneB_S.js";import{_ as F}from"./user-role-dialog.vue_vue_type_script_setup_true_lang-DAUgX2pf.js";import{E as I}from"./panel-B9r8da_r.js";import{E as A}from"./index-BeH0bgk1.js";import"./el-empty-Bo-FTgK-.js";import"./index-CV23GvbI.js";import"./el-option-Dt8TcJ_h.js";import"./index-CYb25bxy.js";import"./index-QUPeURfZ.js";import"./focus-trap-BuAZGuAO.js";import"./index-rMHat4bO.js";import"./error-D_Dr4eZ1.js";import"./index-6gY0_SfG.js";import"./event-BwRzfsZt.js";import"./use-form-item-45aK5G8L.js";import"./vnode-CYrDy7Zs.js";import"./toNumber-C0nrrpRB.js";import"./index-PSpMHiz_.js";/* empty css               *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                    *//* empty css                   */import"./_baseClone-CroWXrxz.js";import"./isArrayLikeObject-GzdkelJI.js";import"./omit-r26JECDk.js";import"./debounce-BR-vWXNg.js";import"./index-vbGq24LZ.js";import"./_plugin-vue_export-helper-BCo6x5W8.js";/* empty css                   */import"./el-dropdown-item-Boc3CbhC.js";import"./refs-Cw5r5QN8.js";import"./index.vue_vue_type_script_setup_true_lang-DKdW2tza.js";import"./index-DV-yJVFt.js";import"./index-DTDAwk7H.js";import"./el-form-item-C4bk_1B8.js";import"./el-row-1BZ70gnV.js";import"./el-col-LwQtdht1.js";import"./el-radio-CQJb9sZI.js";import"./index-jcK5pwfa.js";import"./validator-Db6Ycymn.js";import"./index-nANo4xwk.js";import"./el-dialog-CLVXhprU.js";import"./index-CjiF4d6W.js";import"./el-overlay-113k3ltl.js";import"./index-CAuLSoBq.js";/* empty css                        */import"./el-progress-C41PPBx1.js";import"./index-CIH8T4ex.js";import"./cloneDeep-DC3wzNja.js";import"./isEmpty-D2tJdLuc.js";import"./index-BigAM5ph.js";import"./index-BgfwsAWg.js";import"./index.vue_vue_type_script_setup_true_lang-Bhbic2cZ.js";import"./index.vue_vue_type_script_setup_true_lang-D6G6XbLo.js";import"./index-Cwr_Rdhm.js";const H={class:"user-page art-full-height"},Y=p((Z=n({},{name:"User"}),r(Z,t({__name:"index",setup(e){const r=u(),t=x("add"),s=x(!1),o=x({}),i=x(),a=x([]),p=x({userName:void 0,userGender:void 0,userPhone:void 0,userEmail:void 0,status:""}),{columns:Y,columnChecks:Z,data:$,loading:q,pagination:Q,getData:W,searchParams:X,resetSearchParams:J,handleSizeChange:K,handleCurrentChange:M,refreshData:ee}=G({core:{apiFn:()=>le(),apiParams:n({current:1,size:20},p.value),columnsFactory:()=>[{type:"selection"},{type:"index",width:60,label:"序号"},{prop:"userInfo",label:"用户名",width:280,formatter:e=>w("div",{class:"user flex-c"},[w(I,{class:"size-9.5 rounded-md",src:e.avatar||"",previewSrcList:[e.avatar||""],previewTeleported:!0}),w("div",{class:"ml-2"},[w("p",{class:"user-name"},e.userName),w("p",{class:"email"},e.userEmail)])])},{prop:"userType",label:"用户类型",formatter:e=>{var t;const s=null!=(t={1:"primary",2:"info"}[String(e.userType)])?t:"info";return w(A,{type:s},()=>r.getDictLabelByValue("userType",(null==e?void 0:e.userType)||""))}},{prop:"userGender",label:"性别",sortable:!0,formatter:e=>r.getDictLabelByValue("sex",e.userGender)},{prop:"userPhone",label:"手机号"},{prop:"status",label:"状态",formatter:e=>{var t;const s=null!=(t={1:"success",2:"danger"}[String(e.status)])?t:"info";return w(A,{type:s},()=>r.getDictLabelByValue("status",(null==e?void 0:e.status)||""))}},{prop:"createTime",label:"创建日期",sortable:!0,width:180,formatter:e=>P(e.createTime)},{prop:"operation",label:"操作",width:120,fixed:"right",formatter:e=>w("div",{class:"flex "},[w(D,{type:"edit",onClick:()=>te("edit",e)}),w(U,{list:()=>{const{info:t}=r,s=["assignRoles","delete"];let o=[{key:"assignRoles",label:"赋予角色",icon:"ri-user-add-line"},{key:"reset",label:"初始化密码",icon:"ri-user-received-line"},{key:"delete",label:"删除用户",icon:"ri:delete-bin-4-line",color:"#f56c6c"}];return t.email===e.userEmail&&(o=o.filter(e=>!s.includes(e.key))),o},onClick:r=>se(r,e)})])}]}}),re=e=>{Object.assign(X,e),W()},te=(e,r)=>{t.value=e,o.value=r||{},h(()=>{s.value=!0})},se=(e,r)=>{switch(e.key){case"assignRoles":i.value.handleOpen(r);break;case"reset":oe(r);break;case"delete":ie(r)}},oe=e=>{N.confirm("是否将用户密码重置为[123456]?","系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",beforeClose:(r,t,s)=>l(null,null,function*(){if("confirm"===r){t.confirmButtonLoading=!0,t.confirmButtonText="处理中...";try{const r={userEmail:e.userEmail,password:"123456"};yield k(r),s()}finally{t.confirmButtonLoading=!1,t.confirmButtonText="确定"}}else s()})})},ie=e=>{N.confirm("确定要注销该用户吗?","注销用户",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>l(null,null,function*(){yield E(e),yield W()}))},ae=()=>l(null,null,function*(){try{s.value=!1,o.value={},yield W()}catch(e){}}),ne=e=>{a.value=e},le=()=>l(null,null,function*(){const{userName:e,userPhone:r,userEmail:t,userGender:s,status:o}=X,{from:i,to:a}=R(Q);return yield C({userName:e,userPhone:r,userEmail:t,userGender:s,status:o,from:i,to:a})});return(e,r)=>{const a=z,n=S,l=O,u=B,x=T,h=m("ripple");return c(),d("div",H,[j(L,{modelValue:f(p),"onUpdate:modelValue":r[0]||(r[0]=e=>_(p)?p.value=e:null),onSearch:re,onReset:f(J)},null,8,["modelValue","onReset"]),j(x,{class:"art-table-card",shadow:"never"},{default:v(()=>[j(l,{columns:f(Z),"onUpdate:columns":r[2]||(r[2]=e=>_(Z)?Z.value=e:null),loading:f(q),onRefresh:f(ee)},{left:v(()=>[j(n,{wrap:""},{default:v(()=>[y((c(),g(a,{onClick:r[1]||(r[1]=e=>te("add"))},{default:v(()=>[...r[4]||(r[4]=[b("新增用户",-1)])]),_:1})),[[h]])]),_:1})]),_:1},8,["columns","loading","onRefresh"]),j(u,{"table-layout":"fixed",loading:f(q),data:f($),columns:f(Y),pagination:f(Q),onSelectionChange:ne,"onPagination:sizeChange":f(K),"onPagination:currentChange":f(M)},null,8,["loading","data","columns","pagination","onPagination:sizeChange","onPagination:currentChange"]),j(V,{visible:f(s),"onUpdate:visible":r[3]||(r[3]=e=>_(s)?s.value=e:null),type:f(t),"user-data":f(o),onSubmit:ae},null,8,["visible","type","user-data"]),j(F,{ref_key:"userRoleRef",ref:i,onSuccess:f(W)},null,8,["onSuccess"])]),_:1})])}}}))));var Z;export{Y as default};
