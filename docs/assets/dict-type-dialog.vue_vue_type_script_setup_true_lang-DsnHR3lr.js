var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,i=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l,s=(e,a)=>{for(var t in a||(a={}))r.call(a,t)&&i(e,t,a[t]);if(l)for(var t of l(a))o.call(a,t)&&i(e,t,a[t]);return e},n=(e,l)=>a(e,t(l));import{d,x as u,s as p,m as c,b as m,y as v,z as y,k as f,u as g,f as b,i as h,dP as j,dQ as _,p as x}from"./index-Dp_GRdij.js";import{E as O}from"./el-dialog-CLVXhprU.js";import"./el-overlay-113k3ltl.js";import{E as k}from"./el-button-DUuKddpM.js";import{_ as w}from"./index.vue_vue_type_script_setup_true_lang-D6G6XbLo.js";import{u as P}from"./validator-DPUgmFOR.js";import{c as V}from"./cloneDeep-DC3wzNja.js";import{i as E}from"./isEmpty-D2tJdLuc.js";const D={class:"dialog-footer"},q=d({__name:"dict-type-dialog",emits:["success"],setup(e,{expose:a,emit:t}){const i=t,d=u(),{getDictMap:q}=p(d),C=c(),I=c({visible:!1,loading:!1}),U={name:"",code:"",status:"1",remark:""},z=c({data:V(U),items:x(()=>{var e,a;return[{label:"分类名称",key:"name",type:"input",props:{placeholder:"请输入分类名称",clearable:!0}},{label:"分类编码",key:"code",type:"input",props:{placeholder:"请输入分类编码",clearable:!0}},{label:"状态",key:"status",type:"radiogroup",props:{options:null!=(a=null==(e=q.value)?void 0:e.status)?a:[]}},{label:"描述",key:"remark",type:"input",props:{placeholder:"请输入描述",type:"textarea",rows:4,clearable:!0}}]}),rules:x(()=>({name:[{required:!0,message:"分类名称不能为空",trigger:"change"}],code:[{required:!0,message:"分类编码不能为空",trigger:"change"},{validator:P({table:"dict_type",field:"code",getExcludeId:()=>{var e;return null==(e=z.value.data)?void 0:e.id},message:"分类编码已存在"}),trigger:"change"}]}))}),L=()=>{z.value.data=V(U),I.value=n(s({},g(I)),{visible:!1})},M=()=>{return e=null,a=null,t=function*(){if(C.value)try{yield C.value.validate();try{I.value.loading=!0;const{data:e}=z.value,a=e,{id:t}=a,d=((e,a)=>{var t={};for(var i in e)r.call(e,i)&&a.indexOf(i)<0&&(t[i]=e[i]);if(null!=e&&l)for(var i of l(e))a.indexOf(i)<0&&o.call(e,i)&&(t[i]=e[i]);return t})(a,["id"]),p=s({},d);Q.value?yield _(n(s({},p),{id:t})):yield j(p),yield u().fetchDictList(),i("success"),L()}finally{I.value.loading=!1}}catch(e){}},new Promise((l,r)=>{var o=e=>{try{s(t.next(e))}catch(a){r(a)}},i=e=>{try{s(t.throw(e))}catch(a){r(a)}},s=e=>e.done?l(e.value):Promise.resolve(e.value).then(o,i);s((t=t.apply(e,a)).next())});var e,a,t};a({handleOpen:(e={})=>{I.value=n(s({},g(I)),{visible:!0}),E(e)||(z.value.data=e)}});const Q=x(()=>{var e;return!!(null==(e=z.value.data)?void 0:e.id)});return(e,a)=>{const t=k,l=O;return m(),v(l,{modelValue:g(I).visible,"onUpdate:modelValue":a[1]||(a[1]=e=>g(I).visible=e),title:g(Q)?"编辑字典分类":"新增字典分类",width:"30%","align-center":"","destroy-on-close":""},{footer:y(()=>[b("span",D,[f(t,{onClick:L},{default:y(()=>[...a[2]||(a[2]=[h("取 消",-1)])]),_:1}),f(t,{type:"primary",onClick:M,loading:g(I).loading},{default:y(()=>[...a[3]||(a[3]=[h("确 定",-1)])]),_:1},8,["loading"])])]),default:y(()=>[f(w,{ref_key:"formRef",ref:C,modelValue:g(z).data,"onUpdate:modelValue":a[0]||(a[0]=e=>g(z).data=e),items:g(z).items,rules:g(z).rules,span:24,gutter:20,"label-width":"100px","show-reset":!1,"show-submit":!1},null,8,["modelValue","items","rules"])]),_:1},8,["modelValue","title"])}}});export{q as _};
