var e=Object.defineProperty,l=Object.defineProperties,a=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,d=(l,a,o)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):l[a]=o,i=(e,l)=>{for(var a in l||(l={}))r.call(l,a)&&d(e,a,l[a]);if(o)for(var a of o(l))t.call(l,a)&&d(e,a,l[a]);return e};import{d as s,l as n,w as u,b as m,y as p,z as c,k as f,u as g,i as v,G as y,m as b,p as V,bo as h,ec as j,ed as x}from"./index-Dp_GRdij.js";import{E as _}from"./el-dialog-CLVXhprU.js";import"./el-overlay-113k3ltl.js";import{E as O}from"./el-button-DUuKddpM.js";import{E as w,a as C}from"./el-form-item-C4bk_1B8.js";/* empty css                  *//* empty css                 */import{u as E}from"./validator-DPUgmFOR.js";import{E as N}from"./index-6gY0_SfG.js";import{E as P}from"./index-jcK5pwfa.js";const U=s({__name:"role-edit-dialog",props:{modelValue:{type:Boolean,default:!1},dialogType:{default:"add"},roleData:{default:void 0}},emits:["update:modelValue","success"],setup(e,{emit:d}){const s=e,U=d,k=b(),D=b(!1),q=V({get:()=>s.modelValue,set:e=>U("update:modelValue",e)}),T=n({roleName:[{required:!0,message:"请输入角色名称",trigger:"change"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"change"}],roleCode:[{required:!0,message:"请输入角色编码",trigger:"change"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"change"},{validator:E({table:"roles",field:"role_code",getExcludeId:()=>null==I?void 0:I.id,message:"角色编码已存在"}),trigger:"change"}],description:[{required:!0,message:"请输入角色描述",trigger:"change"}]}),I=n({roleName:"",roleCode:"",description:"",enabled:!0});u(()=>s.modelValue,e=>{e&&z()}),u(()=>s.roleData,e=>{e&&s.modelValue&&z()},{deep:!0});const z=()=>{var e;const{id:l,roleName:a,roleCode:o,description:r,enabled:t}=null!=(e=s.roleData)?e:{};Object.assign(I,{id:l,roleName:a,roleCode:o,description:r,enabled:t})},B=()=>{var e;q.value=!1,null==(e=k.value)||e.resetFields()},F=()=>{return e=null,d=null,n=function*(){var e,d;if(k.value)try{yield k.value.validate();try{D.value=!0;const n=h(I),{id:u}=n,m=((e,l)=>{var a={};for(var d in e)r.call(e,d)&&l.indexOf(d)<0&&(a[d]=e[d]);if(null!=e&&o)for(var d of o(e))l.indexOf(d)<0&&t.call(e,d)&&(a[d]=e[d]);return a})(n,["id"]),p=i({},m);"add"===s.dialogType?yield j(p):yield x((e=i({},p),d={id:u},l(e,a(d))))}finally{D.value=!1}U("success"),B()}catch(n){}},new Promise((l,a)=>{var o=e=>{try{t(n.next(e))}catch(l){a(l)}},r=e=>{try{t(n.throw(e))}catch(l){a(l)}},t=e=>e.done?l(e.value):Promise.resolve(e.value).then(o,r);t((n=n.apply(e,d)).next())});var e,d,n};return(l,a)=>{const o=N,r=C,t=P,d=w,i=O,s=_;return m(),p(s,{modelValue:g(q),"onUpdate:modelValue":a[4]||(a[4]=e=>y(q)?q.value=e:null),title:"add"===e.dialogType?"新增角色":"编辑角色",width:"30%","align-center":"",onClose:B},{footer:c(()=>[f(i,{onClick:B},{default:c(()=>[...a[5]||(a[5]=[v("取消",-1)])]),_:1}),f(i,{type:"primary",onClick:F,loading:g(D)},{default:c(()=>[...a[6]||(a[6]=[v("提交",-1)])]),_:1},8,["loading"])]),default:c(()=>[f(d,{ref_key:"formRef",ref:k,model:g(I),rules:g(T),"label-width":"120px",class:"pr-6"},{default:c(()=>[f(r,{label:"角色名称",prop:"roleName"},{default:c(()=>[f(o,{modelValue:g(I).roleName,"onUpdate:modelValue":a[0]||(a[0]=e=>g(I).roleName=e),placeholder:"请输入角色名称"},null,8,["modelValue"])]),_:1}),f(r,{label:"角色编码",prop:"roleCode"},{default:c(()=>[f(o,{modelValue:g(I).roleCode,"onUpdate:modelValue":a[1]||(a[1]=e=>g(I).roleCode=e),placeholder:"请输入角色编码"},null,8,["modelValue"])]),_:1}),f(r,{label:"描述",prop:"description"},{default:c(()=>[f(o,{modelValue:g(I).description,"onUpdate:modelValue":a[2]||(a[2]=e=>g(I).description=e),type:"textarea",rows:3,placeholder:"请输入角色描述"},null,8,["modelValue"])]),_:1}),f(r,{label:"启用"},{default:c(()=>[f(t,{modelValue:g(I).enabled,"onUpdate:modelValue":a[3]||(a[3]=e=>g(I).enabled=e)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}});export{U as _};
