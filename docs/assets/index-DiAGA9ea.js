var e=Object.defineProperty,t=Object.defineProperties,r=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,l=(t,r,o)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[r]=o,s=(e,t)=>{for(var r in t||(t={}))a.call(t,r)&&l(e,r,t[r]);if(o)for(var r of o(t))i.call(t,r)&&l(e,r,t[r]);return e},n=(e,o)=>t(e,r(o)),p=(e,t,r)=>new Promise((o,a)=>{var i=e=>{try{s(r.next(e))}catch(t){a(t)}},l=e=>{try{s(r.throw(e))}catch(t){a(t)}},s=e=>e.done?o(e.value):Promise.resolve(e.value).then(i,l);s((r=r.apply(e,t)).next())});import{d as m,F as d,b as u,c,H as j,a6 as f,u as _,k as v,G as g,z as h,y as b,i as y,e as x,m as w,a3 as C,e5 as P,e9 as k,di as O,ea as T}from"./index-DocD4lg6.js";import{E as S}from"./el-card-B06Vnpo2.js";import{_ as V}from"./index-BPQccTEq.js";import{_ as E}from"./index-D4rjkLSJ.js";import{E as z,p as B}from"./el-space--HUt1im7.js";import{E as N}from"./el-button-D_FpX5vN.js";import{u as R}from"./useTable-liKy6eJi.js";import{_ as U}from"./index.vue_vue_type_script_setup_true_lang-CdgnTDe5.js";import{_ as A}from"./role-search.vue_vue_type_script_setup_true_lang-BeSYAJlA.js";import{_ as D}from"./role-edit-dialog.vue_vue_type_script_setup_true_lang-CviYQ-N-.js";import{_ as F}from"./role-permission-dialog.vue_vue_type_script_setup_true_lang-DCC3lbI2.js";import"./tree-select-ZGjh6-KT.js";import{E as W}from"./overlay-DzZOJsRm.js";/* empty css              */import{E as G}from"./index-CiwdMdhb.js";import"./el-empty-BMzqL6V1.js";import"./index-B8YGeOD4.js";import"./el-option-CzZzDyq0.js";import"./index-CXepPrJW.js";import"./index-DmiZVFYU.js";import"./focus-trap-CMJEhiq8.js";import"./index-NP_uivuD.js";import"./error-D_Dr4eZ1.js";import"./index-BQDo0aJw.js";import"./event-BwRzfsZt.js";import"./use-form-item-CYVSqIfx.js";import"./vnode-CSsEsc6D.js";import"./toNumber-CGZZzxeH.js";import"./index-C9voYJJp.js";/* empty css               *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                    *//* empty css                   */import"./_baseClone-l1ALzJG5.js";import"./isArrayLikeObject-2PyeHjau.js";import"./omit-Ba47H9Mc.js";import"./debounce-CUa5Mv9U.js";import"./index-CIjb2oSb.js";import"./_plugin-vue_export-helper-BCo6x5W8.js";/* empty css                   */import"./el-dropdown-item-BV4GnYEc.js";import"./refs-Cw5r5QN8.js";import"./index.vue_vue_type_script_setup_true_lang-CQ-lFaSs.js";import"./index-CgtpcOQU.js";import"./index.vue_vue_type_script_setup_true_lang-CYnqVZxc.js";import"./index-CVFQuerj.js";import"./el-form-item-BATHfeAQ.js";import"./el-row-C6QA-4HM.js";import"./el-col-91Qg2GeF.js";import"./el-radio-BCc0r040.js";import"./index-Tq9wvZAa.js";import"./validator-BtxKqV6u.js";import"./index-mxqHeaJB.js";import"./el-dialog-DlC7JF0o.js";import"./index-BPDxHcTG.js";import"./el-overlay-BFiG6gu6.js";import"./index-jnk7giIE.js";/* empty css                  */import"./validator-DBBIe7Ox.js";import"./index-DSCG88Bj.js";/* empty css                */import"./index-D8oSONE_.js";import"./index-BchsOKFE.js";import"./cloneDeep-DHbxZ_0L.js";const H={class:"art-full-height"},I=m(n(s({},{name:"Role"}),{__name:"index",setup(e){const t=w({roleName:void 0,roleCode:void 0,description:void 0,enabled:void 0,daterange:void 0}),r=w(!1),l=w(!1),m=w(!1),I=w(void 0),{columns:Y,columnChecks:$,data:q,loading:L,pagination:Q,getData:X,searchParams:Z,resetSearchParams:J,handleSizeChange:K,handleCurrentChange:M,refreshData:ee}=R({core:{apiFn:()=>se(),apiParams:{current:1,size:20},excludeParams:["daterange"],columnsFactory:()=>[{prop:"roleName",label:"角色名称",minWidth:120},{prop:"roleCode",label:"角色编码",minWidth:120},{prop:"description",label:"角色描述",minWidth:150,showOverflowTooltip:!0},{prop:"enabled",label:"角色状态",width:100,formatter:e=>{const t=e.enabled?{type:"success",text:"启用"}:{type:"warning",text:"禁用"};return C(G,{type:t.type},()=>t.text)}},{prop:"createTime",label:"创建日期",width:180,sortable:!0,formatter:e=>P(e.createTime)},{prop:"operation",label:"操作",width:80,fixed:"right",formatter:e=>C("div",[C(U,{list:[{key:"permission",label:"菜单权限",icon:"ri:user-3-line"},{key:"edit",label:"编辑角色",icon:"ri:edit-2-line"},{key:"delete",label:"删除角色",icon:"ri:delete-bin-4-line",color:"#f56c6c"}],onClick:t=>ae(t,e)})])}]}}),te=w("add"),re=(e,t)=>{l.value=!0,te.value=e,I.value=t},oe=e=>{const t=e,{daterange:r}=t,l=((e,t)=>{var r={};for(var l in e)a.call(e,l)&&t.indexOf(l)<0&&(r[l]=e[l]);if(null!=e&&o)for(var l of o(e))t.indexOf(l)<0&&i.call(e,l)&&(r[l]=e[l]);return r})(t,["daterange"]),[p,m]=Array.isArray(r)?r:[null,null];Object.assign(Z,n(s({},l),{startTime:p,endTime:m})),X()},ae=(e,t)=>{switch(e.key){case"permission":ie(t);break;case"edit":re("edit",t);break;case"delete":le(t)}},ie=e=>{m.value=!0,I.value=e},le=e=>{W.confirm(`确定删除角色"${e.roleName}"吗？此操作不可恢复！`,"删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>p(null,null,function*(){yield k(e),yield ee()})).catch(()=>{O.info("已取消删除")})},se=()=>p(null,null,function*(){const{roleName:e,roleCode:t,description:r,enabled:o,startTime:a,endTime:i}=Z,{from:l,to:s}=B(Q),n={roleName:e,roleCode:t,description:r,enabled:o,startTime:a,endTime:i,from:l,to:s};return yield T(n)});return(e,o)=>{const a=N,i=z,s=E,n=V,p=S,w=d("ripple");return u(),c("div",H,[j(v(A,{modelValue:_(t),"onUpdate:modelValue":o[0]||(o[0]=e=>g(t)?t.value=e:null),onSearch:oe,onReset:_(J)},null,8,["modelValue","onReset"]),[[f,_(r)]]),v(p,{class:"art-table-card",shadow:"never",style:x({"margin-top":_(r)?"12px":"0"})},{default:h(()=>[v(s,{columns:_($),"onUpdate:columns":o[2]||(o[2]=e=>g($)?$.value=e:null),showSearchBar:_(r),"onUpdate:showSearchBar":o[3]||(o[3]=e=>g(r)?r.value=e:null),loading:_(L),onRefresh:_(ee)},{left:h(()=>[v(i,{wrap:""},{default:h(()=>[j((u(),b(a,{onClick:o[1]||(o[1]=e=>re("add"))},{default:h(()=>[...o[6]||(o[6]=[y("新增角色",-1)])]),_:1})),[[w]])]),_:1})]),_:1},8,["columns","showSearchBar","loading","onRefresh"]),v(n,{loading:_(L),data:_(q),columns:_(Y),pagination:_(Q),"onPagination:sizeChange":_(K),"onPagination:currentChange":_(M)},null,8,["loading","data","columns","pagination","onPagination:sizeChange","onPagination:currentChange"])]),_:1},8,["style"]),v(D,{modelValue:_(l),"onUpdate:modelValue":o[4]||(o[4]=e=>g(l)?l.value=e:null),"dialog-type":_(te),"role-data":_(I),onSuccess:_(ee)},null,8,["modelValue","dialog-type","role-data","onSuccess"]),v(F,{modelValue:_(m),"onUpdate:modelValue":o[5]||(o[5]=e=>g(m)?m.value=e:null),"role-data":_(I),onSuccess:_(ee)},null,8,["modelValue","role-data","onSuccess"])])}}}));export{I as default};
