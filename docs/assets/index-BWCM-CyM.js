var e=Object.defineProperty,t=Object.defineProperties,o=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,l=(t,o,r)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[o]=r,s=(e,t)=>{for(var o in t||(t={}))a.call(t,o)&&l(e,o,t[o]);if(r)for(var o of r(t))i.call(t,o)&&l(e,o,t[o]);return e},n=(e,r)=>t(e,o(r)),p=(e,t,o)=>new Promise((r,a)=>{var i=e=>{try{s(o.next(e))}catch(t){a(t)}},l=e=>{try{s(o.throw(e))}catch(t){a(t)}},s=e=>e.done?r(e.value):Promise.resolve(e.value).then(i,l);s((o=o.apply(e,t)).next())});import{d as m,a as d,F as u,e as c,f as j,H as f,p as v,ab as _,u as g,G as h,z as b,y,l as x,g as w,bl as O,a8 as P,bq as C,a_ as T,br as S}from"./index-BKps0qP8.js";import{E as k}from"./el-card-DFe3OQ5P.js";import{_ as V}from"./index-Bq0cFyNI.js";import{_ as E}from"./index-BWuI3jD7.js";import{E as N,p as D}from"./el-space-n6tQawf7.js";import{E as R}from"./el-button-xj0xwwtX.js";import{u as U}from"./useTable-CMfIQ-CQ.js";import{_ as z}from"./index.vue_vue_type_script_setup_true_lang-igCc7akn.js";import{_ as B}from"./role-search.vue_vue_type_script_setup_true_lang-D0gE3mn4.js";import{_ as F}from"./role-edit-dialog.vue_vue_type_script_setup_true_lang-BPeeeYiU.js";import{_ as A}from"./role-permission-dialog.vue_vue_type_script_setup_true_lang-DL01BFII.js";import"./tree-select-C1naRbge.js";import{E as W}from"./overlay-6GiS5FUi.js";/* empty css              */import{E as G}from"./el-option-C0Pcsn-l.js";import"./el-empty-CRZjrFOc.js";import"./index-z60qzp4A.js";import"./index-BPNn2xRB.js";import"./index-gRRlAg83.js";import"./event-BwRzfsZt.js";import"./index-CXoKioUi.js";/* empty css               *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                 *//* empty css                    *//* empty css                   */import"./index-BAqFN-wU.js";import"./index-CZ38rWYd.js";import"./_initCloneObject-151zVqIX.js";import"./isArrayLikeObject-Cjx_eBkY.js";import"./isPlainObject-BmNZ02j7.js";import"./debounce-B2H2UEXA.js";import"./index-BkfA8-Gk.js";import"./index-D5bYnWSH.js";import"./_plugin-vue_export-helper-BCo6x5W8.js";/* empty css                   */import"./el-dropdown-item-USbL2Glt.js";import"./refs-Cw5r5QN8.js";import"./index.vue_vue_type_script_setup_true_lang-03UlV5Fq.js";import"./index-DB-puIxA.js";import"./vnode-BSa7duyX.js";import"./index.vue_vue_type_script_setup_true_lang-BZayHzw1.js";import"./index-C6oTwxSF.js";import"./el-form-item-hM3wKmQZ.js";import"./el-row-QAWxk7s5.js";import"./el-col-85nm_14f.js";import"./el-radio-CaczhC9_.js";import"./index-bSraPVbD.js";import"./validator-1egxnuHX.js";import"./index-CUWElpO2.js";import"./el-dialog-H8ydrYgz.js";import"./index-CH-aUlw7.js";import"./el-overlay-ClgHPMsh.js";/* empty css                  */import"./validator-Dczg3Z3b.js";import"./index-CxXAN8iq.js";/* empty css                */import"./index-CFQIc2Sg.js";import"./token-DWNpOE8r.js";import"./index-CpBMXJZl.js";import"./cloneDeep-FmcBaxaU.js";const H={class:"art-full-height"},L=m(n(s({},{name:"Role"}),{__name:"index",setup(e){const t=d({roleName:void 0,roleCode:void 0,description:void 0,enabled:void 0,daterange:void 0}),o=d(!1),l=d(!1),m=d(!1),L=d(void 0),{columns:q,columnChecks:Q,data:X,loading:$,pagination:I,getData:J,searchParams:K,resetSearchParams:M,handleSizeChange:Y,handleCurrentChange:Z,refreshData:ee}=U({core:{apiFn:()=>se(),apiParams:{current:1,size:20},excludeParams:["daterange"],columnsFactory:()=>[{prop:"roleName",label:"角色名称",minWidth:120},{prop:"roleCode",label:"角色编码",minWidth:120},{prop:"description",label:"角色描述",minWidth:150,showOverflowTooltip:!0},{prop:"enabled",label:"角色状态",width:100,formatter:e=>{const t=e.enabled?{type:"success",text:"启用"}:{type:"warning",text:"禁用"};return P(G,{type:t.type},()=>t.text)}},{prop:"createTime",label:"创建日期",width:180,sortable:!0,formatter:e=>O(e.createTime)},{prop:"operation",label:"操作",width:80,fixed:"right",formatter:e=>P("div",[P(z,{list:[{key:"permission",label:"菜单权限",icon:"ri:user-3-line"},{key:"edit",label:"编辑角色",icon:"ri:edit-2-line"},{key:"delete",label:"删除角色",icon:"ri:delete-bin-4-line",color:"#f56c6c"}],onClick:t=>ae(t,e)})])}]}}),te=d("add"),oe=(e,t)=>{l.value=!0,te.value=e,L.value=t},re=e=>{const t=e,{daterange:o}=t,l=((e,t)=>{var o={};for(var l in e)a.call(e,l)&&t.indexOf(l)<0&&(o[l]=e[l]);if(null!=e&&r)for(var l of r(e))t.indexOf(l)<0&&i.call(e,l)&&(o[l]=e[l]);return o})(t,["daterange"]),[p,m]=Array.isArray(o)?o:[null,null];Object.assign(K,n(s({},l),{startTime:p,endTime:m})),J()},ae=(e,t)=>{switch(e.key){case"permission":ie(t);break;case"edit":oe("edit",t);break;case"delete":le(t)}},ie=e=>{m.value=!0,L.value=e},le=e=>{W.confirm(`确定删除角色"${e.roleName}"吗？此操作不可恢复！`,"删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>p(null,null,function*(){yield C(e),yield ee()})).catch(()=>{T.info("已取消删除")})},se=()=>p(null,null,function*(){const{roleName:e,roleCode:t,description:o,enabled:r,startTime:a,endTime:i}=K,{from:l,to:s}=D(I),n={roleName:e,roleCode:t,description:o,enabled:r,startTime:a,endTime:i,from:l,to:s};return yield S(n)});return(e,r)=>{const a=R,i=N,s=E,n=V,p=k,d=u("ripple");return j(),c("div",H,[f(v(B,{modelValue:g(t),"onUpdate:modelValue":r[0]||(r[0]=e=>h(t)?t.value=e:null),onSearch:re,onReset:g(M)},null,8,["modelValue","onReset"]),[[_,g(o)]]),v(p,{class:"art-table-card",shadow:"never",style:w({"margin-top":g(o)?"12px":"0"})},{default:b(()=>[v(s,{columns:g(Q),"onUpdate:columns":r[2]||(r[2]=e=>h(Q)?Q.value=e:null),showSearchBar:g(o),"onUpdate:showSearchBar":r[3]||(r[3]=e=>h(o)?o.value=e:null),loading:g($),onRefresh:g(ee)},{left:b(()=>[v(i,{wrap:""},{default:b(()=>[f((j(),y(a,{onClick:r[1]||(r[1]=e=>oe("add"))},{default:b(()=>[...r[6]||(r[6]=[x("新增角色",-1)])]),_:1})),[[d]])]),_:1})]),_:1},8,["columns","showSearchBar","loading","onRefresh"]),v(n,{loading:g($),data:g(X),columns:g(q),pagination:g(I),"onPagination:sizeChange":g(Y),"onPagination:currentChange":g(Z)},null,8,["loading","data","columns","pagination","onPagination:sizeChange","onPagination:currentChange"])]),_:1},8,["style"]),v(F,{modelValue:g(l),"onUpdate:modelValue":r[4]||(r[4]=e=>h(l)?l.value=e:null),"dialog-type":g(te),"role-data":g(L),onSuccess:g(ee)},null,8,["modelValue","dialog-type","role-data","onSuccess"]),v(A,{modelValue:g(m),"onUpdate:modelValue":r[5]||(r[5]=e=>h(m)?m.value=e:null),"role-data":g(L),onSuccess:g(ee)},null,8,["modelValue","role-data","onSuccess"])])}}}));export{L as default};
