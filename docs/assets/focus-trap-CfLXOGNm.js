var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,a=(t,n,o)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[n]=o,u=(e,t)=>{for(var n in t||(t={}))r.call(t,n)&&a(e,n,t[n]);if(o)for(var n of o(t))s.call(t,n)&&a(e,n,t[n]);return e},c=(e,o)=>t(e,n(o));import{a9 as l,ab as d,_ as i,d as f,r as p,b as v,y as m,aB as E,ao as b,o as y,a as h,m as w,bn as L,U as T,V as g,w as k,u as A,al as P,n as x,a4 as O,a2 as S}from"./index-DPSTeJg3.js";const I=l({to:{type:d([String,Object]),required:!0},disabled:Boolean});const N=b(i(f({__name:"teleport",props:I,setup:e=>(e,t)=>e.disabled?p(e.$slots,"default",{key:0}):(v(),m(E,{key:1,to:e.to},[p(e.$slots,"default")],8,["to"]))}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/teleport/src/teleport.vue"]])),R=e=>"undefined"!=typeof Element&&e instanceof Element,F=e=>Array.from(e.querySelectorAll('a[href],button:not([disabled]),button:not([hidden]),:not([tabindex="-1"]),input:not([disabled]),input:not([type="hidden"]),select:not([disabled]),textarea:not([disabled])')).filter(e=>K(e)&&(e=>"fixed"!==getComputedStyle(e).position&&null!==e.offsetParent)(e)),K=e=>{if(e.tabIndex>0||0===e.tabIndex&&null!==e.getAttribute("tabIndex"))return!0;if(e.tabIndex<0||e.hasAttribute("disabled")||"true"===e.getAttribute("aria-disabled"))return!1;switch(e.nodeName){case"A":return!!e.href&&"ignore"!==e.rel;case"INPUT":return!("hidden"===e.type||"file"===e.type);case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}},_=function(e,t,...n){let o;o=t.includes("mouse")||t.includes("click")?"MouseEvents":t.includes("key")?"KeyboardEvent":"HTMLEvents";const r=document.createEvent(o);return r.initEvent(t,...n),e.dispatchEvent(r),e},j=e=>!e.getAttribute("aria-owns"),C=(e,t,n)=>{const{parentNode:o}=e;if(!o)return null;const r=o.querySelectorAll(n);return r[Array.prototype.indexOf.call(r,e)+t]||null},q=(e,t)=>{if(!e||!e.focus)return;let n=!1;!R(e)||K(e)||e.getAttribute("tabindex")||(e.setAttribute("tabindex","-1"),n=!0),e.focus(t),R(e)&&n&&e.removeAttribute("tabindex")},B=e=>{e&&(q(e),!j(e)&&e.click())},U="focus-trap.focus-after-trapped",D="focus-trap.focus-after-released",M={cancelable:!0,bubbles:!1},H={cancelable:!0,bubbles:!1},$="focusAfterTrapped",W="focusAfterReleased",V=Symbol("elFocusTrap"),X=w(),z=w(0),G=w(0);let J=0;const Q=e=>{const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{const t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0||e===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t},Y=(e,t)=>{for(const n of e)if(!Z(n,t))return n},Z=(e,t)=>{if("hidden"===getComputedStyle(e).visibility)return!0;for(;e;){if(t&&e===t)return!1;if("none"===getComputedStyle(e).display)return!0;e=e.parentElement}return!1},ee=(e,t)=>{if(e){const n=document.activeElement;q(e,{preventScroll:!0}),G.value=window.performance.now(),e!==n&&(e=>e instanceof HTMLInputElement&&"select"in e)(e)&&t&&e.select()}};function te(e,t){const n=[...e],o=e.indexOf(t);return-1!==o&&n.splice(o,1),n}const ne=(()=>{let e=[];return{push:t=>{const n=e[0];n&&t!==n&&n.pause(),e=te(e,t),e.unshift(t)},remove:t=>{var n,o;e=te(e,t),null==(o=null==(n=e[0])?void 0:n.resume)||o.call(n)}}})(),oe=()=>{X.value="pointer",z.value=window.performance.now()},re=()=>{X.value="keyboard",z.value=window.performance.now()},se=e=>new CustomEvent("focus-trap.focusout-prevented",c(u({},H),{detail:e}));let ae=[];const ue=e=>{T(e)===g.esc&&ae.forEach(t=>t(e))};var ce=i(f({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[$,W,"focusin","focusout","focusout-prevented","release-requested"],setup(e,{emit:t}){const n=w();let o,r;const{focusReason:s}=(y(()=>{0===J&&(document.addEventListener("mousedown",oe),document.addEventListener("touchstart",oe),document.addEventListener("keydown",re)),J++}),h(()=>{J--,J<=0&&(document.removeEventListener("mousedown",oe),document.removeEventListener("touchstart",oe),document.removeEventListener("keydown",re))}),{focusReason:X,lastUserFocusTimestamp:z,lastAutomatedFocusTimestamp:G});var a;a=n=>{e.trapped&&!l.paused&&t("release-requested",n)},y(()=>{0===ae.length&&document.addEventListener("keydown",ue),L&&ae.push(a)}),h(()=>{ae=ae.filter(e=>e!==a),0===ae.length&&L&&document.removeEventListener("keydown",ue)});const l={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},d=n=>{if(!e.loop&&!e.trapped)return;if(l.paused)return;const{altKey:o,ctrlKey:r,metaKey:a,currentTarget:u,shiftKey:c}=n,{loop:d}=e,i=T(n)===g.tab&&!o&&!r&&!a,f=document.activeElement;if(i&&f){const e=u,[o,r]=(e=>{const t=Q(e);return[Y(t,e),Y(t.reverse(),e)]})(e);if(o&&r)if(c||f!==r){if(c&&[o,e].includes(f)){const e=se({focusReason:s.value});t("focusout-prevented",e),e.defaultPrevented||(n.preventDefault(),d&&ee(r,!0))}}else{const e=se({focusReason:s.value});t("focusout-prevented",e),e.defaultPrevented||(n.preventDefault(),d&&ee(o,!0))}else if(f===e){const e=se({focusReason:s.value});t("focusout-prevented",e),e.defaultPrevented||n.preventDefault()}}};S(V,{focusTrapRef:n,onKeydown:d}),k(()=>e.focusTrapEl,e=>{e&&(n.value=e)},{immediate:!0}),k([n],([e],[t])=>{e&&(e.addEventListener("keydown",d),e.addEventListener("focusin",p),e.addEventListener("focusout",v)),t&&(t.removeEventListener("keydown",d),t.removeEventListener("focusin",p),t.removeEventListener("focusout",v))});const i=e=>{t($,e)},f=e=>t(W,e),p=s=>{const a=A(n);if(!a)return;const u=s.target,c=s.relatedTarget,d=u&&a.contains(u);if(!e.trapped){c&&a.contains(c)||(o=c)}d&&t("focusin",s),l.paused||e.trapped&&(d?r=u:ee(r,!0))},v=o=>{const a=A(n);if(!l.paused&&a)if(e.trapped){const n=o.relatedTarget;P(n)||a.contains(n)||setTimeout(()=>{if(!l.paused&&e.trapped){const e=se({focusReason:s.value});t("focusout-prevented",e),e.defaultPrevented||ee(r,!0)}},0)}else{const e=o.target;e&&a.contains(e)||t("focusout",o)}};function m(){return t=this,r=null,s=function*(){yield x();const t=A(n);if(t){ne.push(l);const n=t.contains(document.activeElement)?o:document.activeElement;if(o=n,!t.contains(n)){const o=new Event(U,M);t.addEventListener(U,i),t.dispatchEvent(o),o.defaultPrevented||x(()=>{let o=e.focusStartEl;O(o)||(ee(o),document.activeElement!==o&&(o="first")),"first"===o&&((e,t=!1)=>{const n=document.activeElement;for(const o of e)if(ee(o,t),document.activeElement!==n)return})(Q(t),!0),document.activeElement!==n&&"container"!==o||ee(t)})}}},new Promise((e,n)=>{var o=e=>{try{u(s.next(e))}catch(t){n(t)}},a=e=>{try{u(s.throw(e))}catch(t){n(t)}},u=t=>t.done?e(t.value):Promise.resolve(t.value).then(o,a);u((s=s.apply(t,r)).next())});var t,r,s}function E(){const e=A(n);if(e){e.removeEventListener(U,i);const t=new CustomEvent(D,c(u({},M),{detail:{focusReason:s.value}}));e.addEventListener(D,f),e.dispatchEvent(t),t.defaultPrevented||"keyboard"!=s.value&&z.value>G.value&&!e.contains(document.activeElement)||ee(null!=o?o:document.body),e.removeEventListener(D,f),ne.remove(l),o=null,r=null}}return y(()=>{e.trapped&&m(),k(()=>e.trapped,e=>{e?m():E()})}),h(()=>{e.trapped&&E(),n.value&&(n.value.removeEventListener("keydown",d),n.value.removeEventListener("focusin",p),n.value.removeEventListener("focusout",v),n.value=void 0),o=null,r=null}),{onKeydown:d}}}),[["render",function(e,t,n,o,r,s){return p(e.$slots,"default",{handleKeydown:e.onKeydown})}],["__file","/home/runner/work/element-plus/element-plus/packages/components/focus-trap/src/focus-trap.vue"]]);export{ce as E,V as F,I as a,N as b,j as c,B as d,q as f,C as g,K as i,F as o,_ as t};
