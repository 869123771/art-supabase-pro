var e=Object.defineProperty,l=Object.defineProperties,t=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,r=(l,t,a)=>t in l?e(l,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[t]=a,i=(e,l)=>{for(var t in l||(l={}))s.call(l,t)&&r(e,t,l[t]);if(a)for(var t of a(l))n.call(l,t)&&r(e,t,l[t]);return e},p=(e,a)=>l(e,t(a)),o=(e,l,t)=>new Promise((a,s)=>{var n=e=>{try{i(t.next(e))}catch(l){s(l)}},r=e=>{try{i(t.throw(e))}catch(l){s(l)}},i=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,r);i((t=t.apply(e,l)).next())});import{d as u,a as d,r as y,c,aO as m,aG as b,w as h,y as f,f as v,z as k,p as g,u as w,G as x,l as _,h as T,a8 as P,aa as j,bd as I,a_ as O,bn as B,bo as E,bp as H,n as V}from"./index-D2YTfifR.js";import{E as A}from"./el-dialog-CKnhTw94.js";import"./el-overlay-CYBWNh-f.js";import{E as D}from"./el-button-BGDwCa_e.js";import{a as F,E as U}from"./el-radio-BVqpeKH_.js";/* empty css                        */import"./tree-select-CjF8WcXl.js";import{_ as R}from"./index.vue_vue_type_script_setup_true_lang-CSoiNCaw.js";import{E as q}from"./index-iw_V6QEH.js";import{i as S}from"./isEmpty-BLdwzjFJ.js";const z={class:"dialog-footer"},C=u({__name:"menu-dialog",props:{visible:{type:Boolean,default:!1},editData:{default:{}},type:{default:"menu"},lockType:{type:Boolean,default:!1}},emits:["update:visible","submit"],setup(e,{expose:l,emit:t}){const{width:r}=m(),u=(e,l)=>()=>P("span",{class:"flex items-center"},[P("span",e),P(q,{placement:"top"},{content:()=>"function"==typeof l?l():P("span",{class:"whitespace-pre-line"},l),default:()=>P(j,{class:"ml-0.5 cursor-help"},()=>P(I))})]),C=e,G=t,N=d(),$=d(!1),K=y({type:"menu",parentId:"",name:"",path:"",title:"",component:"",icon:"",isEnable:!0,sort:1,keepAlive:!0,isHide:!1,isHideTab:!1,link:"",isIframe:!1,showBadge:!1,showTextBadge:"",fixedTab:!1,activePath:"",roles:[],isFullPage:!1}),L=d({menuTree:[]}),J=c(()=>K.id),M=c(()=>({name:[{required:!0,message:"请输入名称",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],path:[{required:!0,message:"请输入路由地址",trigger:"blur"}],title:[{required:!0,message:{button:"输入权限标识",menu:"输入菜单名称",folder:"输入目录名称"}[K.type],trigger:"blur"}]})),Q=c(()=>{const e=[{label:"菜单类型",key:"type",span:24}],l=r.value<640?12:6;return["folder"].includes(K.type)?[...e,{label:"父级菜单",key:"parentId",type:"treeselect",props:{clearable:!0,filterable:!0,data:L.value.menuTree,props:{label:e=>{var l;return b(null==(l=e.meta)?void 0:l.title)},value:"id"}}},{label:"目录名称",key:"title",type:"input",props:{placeholder:"目录名称"}},{label:u("路由地址","一级菜单：以 / 开头的绝对路径（如 /dashboard）\n二级及以下：相对路径（如 console、user）"),key:"path",type:"input",props:{placeholder:"如：/dashboard 或 console"}},{label:"权限标识",key:"name",type:"input",props:{placeholder:"如：User"}},{label:u("组件路径","一级父级菜单：填写 /index/index\n具体页面：填写组件路径（如 /system/user）"),key:"component",type:"input",props:{placeholder:"如：/system/user 或留空"}},{label:u("图标",()=>P("div",{class:"leading-5"},[P("a",{href:"https://remixicon.com/",target:"_blank",class:"text-primary underline inline-block"},"Remix Icon 官网 ")])),key:"icon",type:"input",props:{placeholder:"如：ri:user-line"}},{label:"菜单排序",key:"sort",type:"number",props:{min:1,controlsPosition:"right",style:{width:"100%"}}},{label:"文本徽章",key:"showTextBadge",type:"input",props:{placeholder:"如：New、Hot"}},{label:"是否启用",key:"isEnable",type:"switch",span:l},{label:"显示徽章",key:"showBadge",type:"switch",span:l}]:["menu"].includes(K.type)?[...e,{label:"父级菜单",key:"parentId",type:"treeselect",props:{clearable:!0,filterable:!0,data:L.value.menuTree,props:{label:e=>{var l;return b(null==(l=e.meta)?void 0:l.title)},value:"id"}}},{label:"菜单名称",key:"title",type:"input",props:{placeholder:"菜单名称"}},{label:u("路由地址","一级菜单：以 / 开头的绝对路径（如 /dashboard）\n二级及以下：相对路径（如 console、user）"),key:"path",type:"input",props:{placeholder:"如：/dashboard 或 console"}},{label:"权限标识",key:"name",type:"input",props:{placeholder:"如：User"}},{label:u("组件路径","一级父级菜单：填写 /index/index\n具体页面：填写组件路径（如 /system/user）"),key:"component",type:"input",props:{placeholder:"如：/system/user 或留空"}},{label:u("图标",()=>P("div",{class:"leading-5"},[P("a",{href:"https://remixicon.com/",target:"_blank",class:"text-primary underline inline-block"},"Remix Icon 官网 ")])),key:"icon",type:"input",props:{placeholder:"如：ri:user-line"}},{label:"菜单排序",key:"sort",type:"number",props:{min:1,controlsPosition:"right",style:{width:"100%"}}},{label:"外部链接",key:"link",type:"input",props:{placeholder:"如：https://www.example.com"}},{label:"文本徽章",key:"showTextBadge",type:"input",props:{placeholder:"如：New、Hot"}},{label:u("激活路径",'用于详情页等隐藏菜单，指定高亮显示的父级菜单路径\n例如：用户详情页高亮显示"用户管理"菜单'),key:"activePath",type:"input",props:{placeholder:"如：/system/user"}},{label:"是否启用",key:"isEnable",type:"switch",span:l},{label:"页面缓存",key:"keepAlive",type:"switch",span:l},{label:"隐藏菜单",key:"isHide",type:"switch",span:l},{label:"是否内嵌",key:"isIframe",type:"switch",span:l},{label:"显示徽章",key:"showBadge",type:"switch",span:l},{label:"固定标签",key:"fixedTab",type:"switch",span:l},{label:"标签隐藏",key:"isHideTab",type:"switch",span:l},{label:"全屏页面",key:"isFullPage",type:"switch",span:l}]:[...e,{label:"权限名称",key:"title",type:"input",props:{placeholder:"如：新增、编辑、删除"}},{label:"权限标识",key:"name",type:"input",props:{placeholder:"如：add、edit、delete"}},{label:"权限排序",key:"sort",type:"number",props:{min:1,controlsPosition:"right",style:{width:"100%"}}}]}),W=c(()=>{const e={folder:"目录",menu:"菜单",button:"按钮"}[K.type];return J.value?`编辑${e}`:`新建${e}`}),X=c(()=>C.lockType),Y=()=>o(null,null,function*(){var e;yield V();const{ref:l}=N.value;null==(e=l.value)||e.resetFields()}),Z=()=>o(null,null,function*(){if(N.value){try{yield N.value.validate()}catch(e){O.error("表单校验失败，请检查输入")}try{$.value=!0;const e=B(K),{id:l,parentId:t,path:r,component:o,name:u,type:d,sort:y}=e,c=((e,l)=>{var t={};for(var r in e)s.call(e,r)&&l.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&a)for(var r of a(e))l.indexOf(r)<0&&n.call(e,r)&&(t[r]=e[r]);return t})(e,["id","parentId","path","component","name","type","sort"]),m={parentId:null!=t?t:null,path:r,component:o,name:u,type:d,sort:y,meta:i({},c)};S(C.editData)?yield E(m):yield H(p(i({},m),{id:l})),G("submit",i({},K)),ee()}finally{$.value=!1}}}),ee=()=>{G("update:visible",!1),Y()};return h(()=>C.visible,e=>{e&&((()=>{var e,l,t,a,s,n,r,i,p,o,u,d,y;const{id:c,parentId:m=K.parentId,type:h,name:f,sort:v,path:k,component:g,meta:w={}}=null!=(e=C.editData)?e:{};Object.assign(K,{id:c,parentId:m,type:h||C.type,title:b((null==w?void 0:w.title)||""),name:f,sort:v,path:k,component:g,icon:null!=(l=w.icon)?l:"",keepAlive:null!=(t=w.keepAlive)&&t,isHide:null!=(a=w.isHide)&&a,isHideTab:null!=(s=w.isHideTab)&&s,isEnable:null==(n=w.isEnable)||n,link:null!=(r=w.link)?r:"",isIframe:null!=(i=w.isIframe)&&i,showBadge:null!=(p=w.showBadge)&&p,showTextBadge:null!=(o=w.showTextBadge)?o:"",fixedTab:null!=(u=w.fixedTab)&&u,activePath:null!=(d=w.activePath)?d:"",isFullPage:null!=(y=w.isFullPage)&&y})})(),Y())}),l({handleSetParent:(e={})=>{var l;K.parentId=null!=(l=e.id)?l:null,L.value=p(i({},w(L)),{menuTree:e.menuTree})}}),(l,t)=>{const a=U,s=F,n=D,i=A;return v(),f(i,{title:w(W),"model-value":e.visible,"onUpdate:modelValue":ee,width:"860px","align-center":"",class:"menu-dialog","destroy-on-close":""},{footer:k(()=>[T("span",z,[g(n,{onClick:ee},{default:k(()=>[...t[5]||(t[5]=[_("取 消",-1)])]),_:1}),g(n,{type:"primary",onClick:Z,loading:w($)},{default:k(()=>[...t[6]||(t[6]=[_("确 定",-1)])]),_:1},8,["loading"])])]),default:k(()=>[g(R,{ref_key:"formRef",ref:N,modelValue:w(K),"onUpdate:modelValue":t[1]||(t[1]=e=>x(K)?K.value=e:null),items:w(Q),rules:w(M),span:w(r)>640?12:24,gutter:20,"label-width":"100px","show-reset":!1,"show-submit":!1},{type:k(()=>[g(s,{modelValue:w(K).type,"onUpdate:modelValue":t[0]||(t[0]=e=>w(K).type=e),disabled:w(X)},{default:k(()=>[g(a,{value:"folder",label:"menu"},{default:k(()=>[...t[2]||(t[2]=[_("目录",-1)])]),_:1}),g(a,{value:"menu",label:"menu"},{default:k(()=>[...t[3]||(t[3]=[_("菜单",-1)])]),_:1}),g(a,{value:"button",label:"button"},{default:k(()=>[...t[4]||(t[4]=[_("按钮",-1)])]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1},8,["modelValue","items","rules","span"])]),_:1},8,["title","model-value"])}}});export{C as _};
