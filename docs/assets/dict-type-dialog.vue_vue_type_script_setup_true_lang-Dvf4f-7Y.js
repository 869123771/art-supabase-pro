var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,s=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l,i=(e,a)=>{for(var t in a||(a={}))r.call(a,t)&&s(e,t,a[t]);if(l)for(var t of l(a))o.call(a,t)&&s(e,t,a[t]);return e},n=(e,l)=>a(e,t(l));import{d as u,x as d,s as p,a as c,c as m,y as v,f as y,z as f,p as g,u as b,h,l as _,bg as j,bh as x}from"./index-UHpcR4FB.js";import{E as O}from"./el-dialog-DMlvGgU3.js";import"./el-overlay-CLnjAPI7.js";import{E as w}from"./el-button-Dq6xFC1X.js";import{_ as k}from"./index.vue_vue_type_script_setup_true_lang-Cl3sZWJc.js";import{u as P}from"./validator-CDYjpyyO.js";import{c as V}from"./cloneDeep-Da4gXPlP.js";import{i as D}from"./isEmpty--QoX21K3.js";const E={class:"dialog-footer"},U=u({__name:"dict-type-dialog",emits:["success"],setup(e,{expose:a,emit:t}){const s=t,u=d(),{getDictMap:U}=p(u),q=c(),C=c({visible:!1,loading:!1}),I={name:"",code:"",status:"1",remark:""},L=c({data:V(I),items:m(()=>{var e,a;return[{label:"分类名称",key:"name",type:"input",props:{placeholder:"请输入分类名称",clearable:!0}},{label:"分类编码",key:"code",type:"input",props:{placeholder:"请输入分类编码",clearable:!0}},{label:"状态",key:"status",type:"radiogroup",props:{options:null!=(a=null==(e=U.value)?void 0:e.status)?a:[]}},{label:"描述",key:"remark",type:"input",props:{placeholder:"请输入描述",type:"textarea",rows:4,clearable:!0}}]}),rules:m(()=>({name:[{required:!0,message:"分类名称不能为空",trigger:"change"}],code:[{required:!0,message:"分类编码不能为空",trigger:"change"},{validator:P({table:"dict_type",field:"code",getExcludeId:()=>{var e;return null==(e=L.value.data)?void 0:e.id},message:"分类编码已存在"}),trigger:"change"}]}))}),R=()=>{L.value.data=V(I),C.value=n(i({},b(C)),{visible:!1})},S=()=>{return e=null,a=null,t=function*(){if(q.value)try{yield q.value.validate();try{C.value.loading=!0;const{data:e}=L.value,a=e,{id:t}=a,u=((e,a)=>{var t={};for(var s in e)r.call(e,s)&&a.indexOf(s)<0&&(t[s]=e[s]);if(null!=e&&l)for(var s of l(e))a.indexOf(s)<0&&o.call(e,s)&&(t[s]=e[s]);return t})(a,["id"]),p=i({},u);z.value?yield x(n(i({},p),{id:t})):yield j(p),yield d().fetchDictList(),s("success"),R()}finally{C.value.loading=!1}}catch(e){}},new Promise((l,r)=>{var o=e=>{try{i(t.next(e))}catch(a){r(a)}},s=e=>{try{i(t.throw(e))}catch(a){r(a)}},i=e=>e.done?l(e.value):Promise.resolve(e.value).then(o,s);i((t=t.apply(e,a)).next())});var e,a,t};a({handleOpen:(e={})=>{C.value=n(i({},b(C)),{visible:!0}),D(e)||(L.value.data=e)}});const z=m(()=>{var e;return!!(null==(e=L.value.data)?void 0:e.id)});return(e,a)=>{const t=w,l=O;return y(),v(l,{modelValue:b(C).visible,"onUpdate:modelValue":a[1]||(a[1]=e=>b(C).visible=e),title:b(z)?"编辑字典分类":"新增字典分类",width:"30%","align-center":"","destroy-on-close":""},{footer:f(()=>[h("span",E,[g(t,{onClick:R},{default:f(()=>[...a[2]||(a[2]=[_("取 消",-1)])]),_:1}),g(t,{type:"primary",onClick:S,loading:b(C).loading},{default:f(()=>[...a[3]||(a[3]=[_("确 定",-1)])]),_:1},8,["loading"])])]),default:f(()=>[g(k,{ref_key:"formRef",ref:q,modelValue:b(L).data,"onUpdate:modelValue":a[0]||(a[0]=e=>b(L).data=e),items:b(L).items,rules:b(L).rules,span:24,gutter:20,"label-width":"100px","show-reset":!1,"show-submit":!1},null,8,["modelValue","items","rules"])]),_:1},8,["modelValue","title"])}}});export{U as _};
