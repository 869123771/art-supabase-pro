var e=Object.defineProperty,l=Object.defineProperties,t=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,r=(l,t,a)=>t in l?e(l,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[t]=a,i=(e,l)=>{for(var t in l||(l={}))s.call(l,t)&&r(e,t,l[t]);if(a)for(var t of a(l))n.call(l,t)&&r(e,t,l[t]);return e},p=(e,a)=>l(e,t(a)),o=(e,l,t)=>new Promise((a,s)=>{var n=e=>{try{i(t.next(e))}catch(l){s(l)}},r=e=>{try{i(t.throw(e))}catch(l){s(l)}},i=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,r);i((t=t.apply(e,l)).next())});import{d as u,w as d,b as y,y as c,z as m,k as b,u as h,G as f,i as v,f as k,aN as g,m as w,l as x,p as _,di as T,bo as P,e7 as j,e8 as I,n as B,aG as O,a3 as E,a5 as H,dn as V}from"./index-Dp_GRdij.js";import{E as F}from"./el-dialog-CLVXhprU.js";import"./el-overlay-113k3ltl.js";import{E as U}from"./el-button-DUuKddpM.js";import{a as A,E as D}from"./el-radio-CQJb9sZI.js";/* empty css                        */import"./tree-select-BlNR38ws.js";import{_ as q}from"./index.vue_vue_type_script_setup_true_lang-D6G6XbLo.js";import{i as N}from"./isEmpty-D2tJdLuc.js";import{E as R}from"./index-CYb25bxy.js";const $={class:"dialog-footer"},C=u({__name:"menu-dialog",props:{visible:{type:Boolean,default:!1},editData:{default:{}},type:{default:"menu"},lockType:{type:Boolean,default:!1}},emits:["update:visible","submit"],setup(e,{expose:l,emit:t}){const{width:r}=g(),u=(e,l)=>()=>E("span",{class:"flex items-center"},[E("span",e),E(R,{placement:"top"},{content:()=>"function"==typeof l?l():E("span",{class:"whitespace-pre-line"},l),default:()=>E(H,{class:"ml-0.5 cursor-help"},()=>E(V))})]),C=e,G=t,S=w(),z=w(!1),Z=x({type:"menu",parentId:"",name:"",path:"",title:"",component:"",icon:"",isEnable:!0,sort:1,keepAlive:!0,isHide:!1,isHideTab:!1,link:"",isIframe:!1,showBadge:!1,showTextBadge:"",fixedTab:!1,activePath:"",roles:[],isFullPage:!1}),J=w({menuTree:[]}),K=_(()=>Z.id),L=_(()=>({name:[{required:!0,message:"请输入名称",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],path:[{required:!0,message:"请输入路由地址",trigger:"blur"}],title:[{required:!0,message:{button:"输入权限标识",menu:"输入菜单名称",folder:"输入目录名称"}[Z.type],trigger:"blur"}]})),M=_(()=>{const e=[{label:"菜单类型",key:"type",span:24}],l=r.value<640?12:6;return["folder"].includes(Z.type)?[...e,{label:"父级菜单",key:"parentId",type:"treeselect",props:{clearable:!0,filterable:!0,data:J.value.menuTree,props:{label:e=>{var l;return O(null==(l=e.meta)?void 0:l.title)},value:"id"}}},{label:"目录名称",key:"title",type:"input",props:{placeholder:"目录名称"}},{label:u("路由地址","一级菜单：以 / 开头的绝对路径（如 /dashboard）\n二级及以下：相对路径（如 console、user）"),key:"path",type:"input",props:{placeholder:"如：/dashboard 或 console"}},{label:"权限标识",key:"name",type:"input",props:{placeholder:"如：User"}},{label:u("组件路径","一级父级菜单：填写 /index/index\n具体页面：填写组件路径（如 /system/user）"),key:"component",type:"input",props:{placeholder:"如：/system/user 或留空"}},{label:u("图标",()=>E("div",{class:"leading-5"},[E("a",{href:"https://remixicon.com/",target:"_blank",class:"text-primary underline inline-block"},"Remix Icon 官网 ")])),key:"icon",type:"input",props:{placeholder:"如：ri:user-line"}},{label:"菜单排序",key:"sort",type:"number",props:{min:1,controlsPosition:"right",style:{width:"100%"}}},{label:"文本徽章",key:"showTextBadge",type:"input",props:{placeholder:"如：New、Hot"}},{label:"是否启用",key:"isEnable",type:"switch",span:l},{label:"显示徽章",key:"showBadge",type:"switch",span:l}]:["menu"].includes(Z.type)?[...e,{label:"父级菜单",key:"parentId",type:"treeselect",props:{clearable:!0,filterable:!0,data:J.value.menuTree,props:{label:e=>{var l;return O(null==(l=e.meta)?void 0:l.title)},value:"id"}}},{label:"菜单名称",key:"title",type:"input",props:{placeholder:"菜单名称"}},{label:u("路由地址","一级菜单：以 / 开头的绝对路径（如 /dashboard）\n二级及以下：相对路径（如 console、user）"),key:"path",type:"input",props:{placeholder:"如：/dashboard 或 console"}},{label:"权限标识",key:"name",type:"input",props:{placeholder:"如：User"}},{label:u("组件路径","一级父级菜单：填写 /index/index\n具体页面：填写组件路径（如 /system/user）"),key:"component",type:"input",props:{placeholder:"如：/system/user 或留空"}},{label:u("图标",()=>E("div",{class:"leading-5"},[E("a",{href:"https://remixicon.com/",target:"_blank",class:"text-primary underline inline-block"},"Remix Icon 官网 ")])),key:"icon",type:"input",props:{placeholder:"如：ri:user-line"}},{label:"菜单排序",key:"sort",type:"number",props:{min:1,controlsPosition:"right",style:{width:"100%"}}},{label:"外部链接",key:"link",type:"input",props:{placeholder:"如：https://www.example.com"}},{label:"文本徽章",key:"showTextBadge",type:"input",props:{placeholder:"如：New、Hot"}},{label:u("激活路径",'用于详情页等隐藏菜单，指定高亮显示的父级菜单路径\n例如：用户详情页高亮显示"用户管理"菜单'),key:"activePath",type:"input",props:{placeholder:"如：/system/user"}},{label:"是否启用",key:"isEnable",type:"switch",span:l},{label:"页面缓存",key:"keepAlive",type:"switch",span:l},{label:"隐藏菜单",key:"isHide",type:"switch",span:l},{label:"是否内嵌",key:"isIframe",type:"switch",span:l},{label:"显示徽章",key:"showBadge",type:"switch",span:l},{label:"固定标签",key:"fixedTab",type:"switch",span:l},{label:"标签隐藏",key:"isHideTab",type:"switch",span:l},{label:"全屏页面",key:"isFullPage",type:"switch",span:l}]:[...e,{label:"权限名称",key:"title",type:"input",props:{placeholder:"如：新增、编辑、删除"}},{label:"权限标识",key:"name",type:"input",props:{placeholder:"如：add、edit、delete"}},{label:"权限排序",key:"sort",type:"number",props:{min:1,controlsPosition:"right",style:{width:"100%"}}}]}),Q=_(()=>{const e={folder:"目录",menu:"菜单",button:"按钮"}[Z.type];return K.value?`编辑${e}`:`新建${e}`}),W=_(()=>C.lockType),X=()=>o(null,null,function*(){var e;yield B();const{ref:l}=S.value;null==(e=l.value)||e.resetFields()}),Y=()=>o(null,null,function*(){if(S.value){try{yield S.value.validate()}catch(e){T.error("表单校验失败，请检查输入")}try{z.value=!0;const e=P(Z),{id:l,parentId:t,path:r,component:o,name:u,type:d,sort:y}=e,c=((e,l)=>{var t={};for(var r in e)s.call(e,r)&&l.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&a)for(var r of a(e))l.indexOf(r)<0&&n.call(e,r)&&(t[r]=e[r]);return t})(e,["id","parentId","path","component","name","type","sort"]),m={parentId:null!=t?t:null,path:r,component:o,name:u,type:d,sort:y,meta:i({},c)};N(C.editData)?yield j(m):yield I(p(i({},m),{id:l})),G("submit",i({},Z)),ee()}finally{z.value=!1}}}),ee=()=>{G("update:visible",!1),X()};return d(()=>C.visible,e=>{e&&((()=>{var e,l,t,a,s,n,r,i,p,o,u,d,y;const{id:c,parentId:m=Z.parentId,type:b,name:h,sort:f,path:v,component:k,meta:g={}}=null!=(e=C.editData)?e:{};Object.assign(Z,{id:c,parentId:m,type:b||C.type,title:O((null==g?void 0:g.title)||""),name:h,sort:f,path:v,component:k,icon:null!=(l=g.icon)?l:"",keepAlive:null!=(t=g.keepAlive)&&t,isHide:null!=(a=g.isHide)&&a,isHideTab:null!=(s=g.isHideTab)&&s,isEnable:null==(n=g.isEnable)||n,link:null!=(r=g.link)?r:"",isIframe:null!=(i=g.isIframe)&&i,showBadge:null!=(p=g.showBadge)&&p,showTextBadge:null!=(o=g.showTextBadge)?o:"",fixedTab:null!=(u=g.fixedTab)&&u,activePath:null!=(d=g.activePath)?d:"",isFullPage:null!=(y=g.isFullPage)&&y})})(),X())}),l({handleSetParent:(e={})=>{var l;Z.parentId=null!=(l=e.id)?l:null,J.value=p(i({},h(J)),{menuTree:e.menuTree})}}),(l,t)=>{const a=D,s=A,n=U,i=F;return y(),c(i,{title:h(Q),"model-value":e.visible,"onUpdate:modelValue":ee,width:"860px","align-center":"",class:"menu-dialog","destroy-on-close":""},{footer:m(()=>[k("span",$,[b(n,{onClick:ee},{default:m(()=>[...t[5]||(t[5]=[v("取 消",-1)])]),_:1}),b(n,{type:"primary",onClick:Y,loading:h(z)},{default:m(()=>[...t[6]||(t[6]=[v("确 定",-1)])]),_:1},8,["loading"])])]),default:m(()=>[b(q,{ref_key:"formRef",ref:S,modelValue:h(Z),"onUpdate:modelValue":t[1]||(t[1]=e=>f(Z)?Z.value=e:null),items:h(M),rules:h(L),span:h(r)>640?12:24,gutter:20,"label-width":"100px","show-reset":!1,"show-submit":!1},{type:m(()=>[b(s,{modelValue:h(Z).type,"onUpdate:modelValue":t[0]||(t[0]=e=>h(Z).type=e),disabled:h(W)},{default:m(()=>[b(a,{value:"folder",label:"menu"},{default:m(()=>[...t[2]||(t[2]=[v("目录",-1)])]),_:1}),b(a,{value:"menu",label:"menu"},{default:m(()=>[...t[3]||(t[3]=[v("菜单",-1)])]),_:1}),b(a,{value:"button",label:"button"},{default:m(()=>[...t[4]||(t[4]=[v("按钮",-1)])]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1},8,["modelValue","items","rules","span"])]),_:1},8,["title","model-value"])}}});export{C as _};
